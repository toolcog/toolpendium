{
  "name": "dependency-graph_create-repository-snapshot",
  "description": "Create a new snapshot of a repository's dependencies. You must authenticate using an access token with the `repo` scope to use this endpoint for a repository that the requesting user has access to.",
  "parameters": {
    "type": "object",
    "properties": {
      "owner": {
        "type": "string",
        "description": "The account owner of the repository. The name is not case sensitive."
      },
      "repo": {
        "type": "string",
        "description": "The name of the repository. The name is not case sensitive."
      },
      "body": {
        "$ref": "#/$defs/snapshot"
      }
    },
    "required": [
      "owner",
      "repo",
      "body"
    ],
    "$defs": {
      "snapshot": {
        "additionalProperties": false,
        "description": "Create a new snapshot of a repository's dependencies.",
        "properties": {
          "detector": {
            "additionalProperties": false,
            "description": "A description of the detector used.",
            "properties": {
              "name": {
                "description": "The name of the detector used.",
                "example": "docker buildtime detector",
                "type": "string"
              },
              "url": {
                "description": "The url of the detector used.",
                "example": "http://example.com/docker-buildtimer-detector",
                "type": "string"
              },
              "version": {
                "description": "The version of the detector used.",
                "example": "1.0.0",
                "type": "string"
              }
            },
            "required": [
              "name",
              "version",
              "url"
            ],
            "type": "object"
          },
          "job": {
            "additionalProperties": false,
            "properties": {
              "correlator": {
                "description": "Correlator provides a key that is used to group snapshots submitted over time. Only the \"latest\" submitted snapshot for a given combination of `job.correlator` and `detector.name` will be considered when calculating a repository's current dependencies. Correlator should be as unique as it takes to distinguish all detection runs for a given \"wave\" of CI workflow you run. If you're using GitHub Actions, a good default value for this could be the environment variables GITHUB_WORKFLOW and GITHUB_JOB concatenated together. If you're using a build matrix, then you'll also need to add additional key(s) to distinguish between each submission inside a matrix variation.",
                "example": "yourworkflowname_yourjobname",
                "type": "string"
              },
              "html_url": {
                "description": "The url for the job.",
                "example": "http://example.com/build",
                "type": "string"
              },
              "id": {
                "description": "The external ID of the job.",
                "example": "5622a2b0-63f6-4732-8c34-a1ab27e102a11",
                "type": "string"
              }
            },
            "required": [
              "id",
              "correlator"
            ],
            "type": "object"
          },
          "manifests": {
            "additionalProperties": {
              "$ref": "#/$defs/manifest"
            },
            "description": "A collection of package manifests, which are a collection of related dependencies declared in a file or representing a logical group of dependencies.",
            "type": "object"
          },
          "metadata": {
            "$ref": "#/$defs/metadata"
          },
          "ref": {
            "description": "The repository branch that triggered this snapshot.",
            "example": "refs/heads/main",
            "pattern": "^refs/",
            "type": "string"
          },
          "scanned": {
            "description": "The time at which the snapshot was scanned.",
            "example": "2020-06-13T14:52:50-05:00",
            "format": "date-time",
            "type": "string"
          },
          "sha": {
            "description": "The commit SHA associated with this dependency snapshot. Maximum length: 40 characters.",
            "example": "ddc951f4b1293222421f2c8df679786153acf689",
            "maxLength": 40,
            "minLength": 40,
            "type": "string"
          },
          "version": {
            "description": "The version of the repository snapshot submission.",
            "type": "integer"
          }
        },
        "required": [
          "detector",
          "version",
          "ref",
          "sha",
          "job",
          "scanned"
        ],
        "title": "snapshot",
        "type": "object"
      },
      "manifest": {
        "additionalProperties": false,
        "properties": {
          "file": {
            "additionalProperties": false,
            "properties": {
              "source_location": {
                "description": "The path of the manifest file relative to the root of the Git repository.",
                "example": "/src/build/package-lock.json",
                "type": "string"
              }
            },
            "type": "object"
          },
          "metadata": {
            "$ref": "#/$defs/metadata"
          },
          "name": {
            "description": "The name of the manifest.",
            "example": "package-lock.json",
            "type": "string"
          },
          "resolved": {
            "additionalProperties": {
              "$ref": "#/$defs/dependency"
            },
            "description": "A collection of resolved package dependencies.",
            "type": "object"
          }
        },
        "required": [
          "name"
        ],
        "type": "object"
      },
      "metadata": {
        "additionalProperties": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "number"
            },
            {
              "type": "boolean"
            }
          ],
          "nullable": true
        },
        "description": "User-defined metadata to store domain-specific information limited to 8 keys with scalar values.",
        "maxProperties": 8,
        "title": "metadata",
        "type": "object"
      },
      "dependency": {
        "additionalProperties": false,
        "properties": {
          "dependencies": {
            "description": "Array of package-url (PURLs) of direct child dependencies.",
            "example": "@actions/http-client",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "metadata": {
            "$ref": "#/$defs/metadata"
          },
          "package_url": {
            "description": "Package-url (PURL) of dependency. See https://github.com/package-url/purl-spec for more details.",
            "example": "pkg:/npm/%40actions/http-client@1.0.11",
            "pattern": "^pkg",
            "type": "string"
          },
          "relationship": {
            "description": "A notation of whether a dependency is requested directly by this manifest or is a dependency of another dependency.",
            "enum": [
              "direct",
              "indirect"
            ],
            "example": "direct",
            "type": "string"
          },
          "scope": {
            "description": "A notation of whether the dependency is required for the primary build artifact (runtime) or is only used for development. Future versions of this specification may allow for more granular scopes.",
            "enum": [
              "runtime",
              "development"
            ],
            "example": "runtime",
            "type": "string"
          }
        },
        "type": "object"
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://github.com//repos/{owner}/{repo}/dependency-graph/snapshots"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "201": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**created_at**: The time at which the snapshot was created.",
            "**id**: ID of the created snapshot.",
            "**message**: A message providing further details about the result, such as why the dependencies were not updated.",
            "**result**: Either \"SUCCESS\", \"ACCEPTED\", or \"INVALID\". \"SUCCESS\" indicates that the snapshot was successfully created and the repository's dependencies were updated. \"ACCEPTED\" indicates that the snapshot was successfully created, but the repository's dependencies were not updated. \"INVALID\" indicates that the snapshot was malformed."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
