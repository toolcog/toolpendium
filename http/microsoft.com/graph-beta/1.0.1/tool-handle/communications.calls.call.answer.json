{
  "name": "communications_calls_call_answer",
  "description": "Enable a bot to answer an incoming call. The incoming call request can be an invite from a participant in a group call or a peer-to-peer call. If an invite to a group call is received, the notification will contain the chatInfo and meetingInfo parameters. The bot is expected to answer, reject or redirect the call before the call times out. The current timeout value is 15 seconds. The current timeout value is 15 seconds for regular scenarios, and 5 seconds for policy-based recording scenarios.",
  "parameters": {
    "type": "object",
    "properties": {
      "call-id": {
        "type": "string",
        "description": "key: id of call"
      },
      "body": {
        "properties": {
          "acceptedModalities": {
            "items": {
              "anyOf": [
                {
                  "$ref": "#/$defs/microsoft.graph.modality"
                },
                {
                  "nullable": true,
                  "type": "object"
                }
              ]
            },
            "type": "array"
          },
          "callOptions": {
            "anyOf": [
              {
                "$ref": "#/$defs/microsoft.graph.incomingCallOptions"
              },
              {
                "nullable": true,
                "type": "object"
              }
            ]
          },
          "callbackUri": {
            "type": "string"
          },
          "mediaConfig": {
            "$ref": "#/$defs/microsoft.graph.mediaConfig"
          },
          "participantCapacity": {
            "format": "int32",
            "maximum": 2147483647,
            "minimum": -2147483648,
            "nullable": true,
            "type": "integer"
          }
        },
        "type": "object",
        "description": "Action parameters"
      }
    },
    "required": [
      "call-id",
      "body"
    ],
    "$defs": {
      "microsoft.graph.modality": {
        "enum": [
          "unknown",
          "audio",
          "video",
          "videoBasedScreenSharing",
          "data",
          "unknownFutureValue"
        ],
        "title": "modality",
        "type": "string"
      },
      "microsoft.graph.incomingCallOptions": {
        "allOf": [
          {
            "$ref": "#/$defs/microsoft.graph.callOptions"
          },
          {
            "properties": {
              "@odata.type": {
                "default": "#microsoft.graph.incomingCallOptions",
                "type": "string"
              }
            },
            "required": [
              "@odata.type"
            ],
            "title": "incomingCallOptions",
            "type": "object"
          }
        ],
        "x-ms-discriminator-value": "#microsoft.graph.incomingCallOptions"
      },
      "microsoft.graph.callOptions": {
        "discriminator": {
          "mapping": {
            "#microsoft.graph.incomingCallOptions": "#/components/schemas/microsoft.graph.incomingCallOptions",
            "#microsoft.graph.outgoingCallOptions": "#/components/schemas/microsoft.graph.outgoingCallOptions"
          },
          "propertyName": "@odata.type"
        },
        "properties": {
          "@odata.type": {
            "type": "string"
          },
          "hideBotAfterEscalation": {
            "description": "Indicates whether to hide the app after the call is escalated.",
            "nullable": true,
            "type": "boolean"
          },
          "isContentSharingNotificationEnabled": {
            "description": "Indicates whether content sharing notifications should be enabled for the call.",
            "nullable": true,
            "type": "boolean"
          }
        },
        "required": [
          "@odata.type"
        ],
        "title": "callOptions",
        "type": "object"
      },
      "microsoft.graph.mediaConfig": {
        "discriminator": {
          "mapping": {
            "#microsoft.graph.appHostedMediaConfig": "#/components/schemas/microsoft.graph.appHostedMediaConfig",
            "#microsoft.graph.serviceHostedMediaConfig": "#/components/schemas/microsoft.graph.serviceHostedMediaConfig"
          },
          "propertyName": "@odata.type"
        },
        "properties": {
          "@odata.type": {
            "type": "string"
          },
          "removeFromDefaultAudioGroup": {
            "nullable": true,
            "type": "boolean"
          }
        },
        "required": [
          "@odata.type"
        ],
        "title": "mediaConfig",
        "type": "object"
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://graph.microsoft.com/beta/communications/calls/{call-id}/microsoft.graph.answer"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "4XX": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            [
              "**error**",
              {
                "$ul": [
                  "**code**",
                  "**details**",
                  [
                    "**innererror**",
                    {
                      "$ul": [
                        "**@odata.type**",
                        "**Date**: Date when the error occured.",
                        "**client-request-id**: Client request Id as sent by the client application.",
                        "**request-id**: Request Id as tracked internally by the service"
                      ]
                    }
                  ],
                  "**message**",
                  "**target**"
                ]
              }
            ]
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "5XX": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            [
              "**error**",
              {
                "$ul": [
                  "**code**",
                  "**details**",
                  [
                    "**innererror**",
                    {
                      "$ul": [
                        "**@odata.type**",
                        "**Date**: Date when the error occured.",
                        "**client-request-id**: Client request Id as sent by the client application.",
                        "**request-id**: Request Id as tracked internally by the service"
                      ]
                    }
                  ],
                  "**message**",
                  "**target**"
                ]
              }
            ]
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
