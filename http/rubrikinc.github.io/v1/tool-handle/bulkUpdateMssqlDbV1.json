{
  "name": "bulkUpdateMssqlDbV1",
  "description": "Update multiple Microsoft SQL databases with the specified properties.",
  "parameters": {
    "type": "object",
    "properties": {
      "body": {
        "items": {
          "$ref": "#/$defs/MssqlDbUpdateId"
        },
        "type": "array",
        "description": "Properties to update for each database."
      }
    },
    "required": [
      "body"
    ],
    "$defs": {
      "MssqlDbUpdateId": {
        "properties": {
          "databaseId": {
            "description": "ID of the Microsoft SQL database.",
            "type": "string"
          },
          "updateProperties": {
            "$ref": "#/$defs/MssqlDbUpdate"
          }
        },
        "required": [
          "databaseId",
          "updateProperties"
        ],
        "type": "object"
      },
      "MssqlDbUpdate": {
        "allOf": [
          {
            "$ref": "#/$defs/MssqlSlaPatchProperties"
          },
          {
            "properties": {
              "isPaused": {
                "description": "Whether to pause or resume backups/archival for this database.",
                "type": "boolean"
              },
              "maxDataStreams": {
                "description": "Maximum number of parallel data streams that can be used to back up the database.",
                "format": "int32",
                "type": "integer"
              },
              "postBackupScript": {
                "$ref": "#/$defs/MssqlScriptDetail"
              },
              "preBackupScript": {
                "$ref": "#/$defs/MssqlScriptDetail"
              },
              "shouldForceFull": {
                "description": "Determines whether to force a full for the next snapshot of a SQL Server database. When this value is true, the Rubrik cluster takes a full snapshot. This value is false by default and is reset to false after a successful full snapshot.",
                "type": "boolean"
              }
            },
            "type": "object"
          }
        ]
      },
      "MssqlSlaPatchProperties": {
        "allOf": [
          {
            "$ref": "#/$defs/MssqlSlaRelatedProperties"
          },
          {
            "properties": {
              "configuredSlaDomainId": {
                "description": "SLA Domain ID assigned to instance. Existing snapshots of the instance will be retained with the configuration of specified SLA Domain.",
                "type": "string"
              },
              "useConfiguredDefaultLogRetention": {
                "description": "Determines whether to use the configured default value of log backup retention.",
                "type": "boolean"
              }
            },
            "type": "object"
          }
        ]
      },
      "MssqlSlaRelatedProperties": {
        "properties": {
          "copyOnly": {
            "description": "Boolean value that specifies whether or not to perform copy-only backups of the database. When true, database backups are copy-only backups. When false, database backups are full backups.",
            "type": "boolean"
          },
          "logBackupFrequencyInSeconds": {
            "description": "Seconds between two log backups. A value of 0 disables log backup.",
            "format": "int32",
            "type": "integer"
          },
          "logRetentionHours": {
            "description": "Number of hours to retain a log backup. When the value is set to -1 the Rubrik cluster retains the log backup until the database snapshots that precede the log backup have expired.",
            "format": "int32",
            "type": "integer"
          }
        },
        "type": "object"
      },
      "MssqlScriptDetail": {
        "properties": {
          "scriptErrorAction": {
            "$ref": "#/$defs/ScriptErrorAction"
          },
          "scriptPath": {
            "description": "The script to be run.",
            "type": "string"
          },
          "timeoutMs": {
            "description": "Time (in ms) after which the script will be terminated if it has not completed.",
            "format": "int64",
            "type": "integer"
          }
        },
        "required": [
          "scriptErrorAction",
          "scriptPath",
          "timeoutMs"
        ],
        "type": "object",
        "x-rk-nullable-properties": [
          "scriptPath",
          "timeoutMs",
          "scriptErrorAction"
        ]
      },
      "ScriptErrorAction": {
        "description": "Action to take if the script returns an error or times out.",
        "enum": [
          "abort",
          "continue"
        ],
        "type": "string"
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "PATCH",
    "url": {
      "$uri": "/api/v1/mssql/db/bulk"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "List"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**configuredSlaDomainId**: The ID of the SLA Domain configured directly on the Rubrik object.",
            "**configuredSlaDomainName**: The name of the SLA Domain configured directly on the Rubrik object.",
            "**configuredSlaDomainType**: Specifies whether the SLA Domain is used for protection or retention.",
            "**id**",
            "**isConfiguredSlaDomainRetentionLocked**: Indicates whether the configured SLA Domain is Retention Locked. When this value is 'true', the configured SLA Domain is a Retention Lock SLA Domain.",
            "**name**",
            "**primaryClusterId**",
            "**slaLastUpdateTime**: The UTC time when the SLA Domain was last updated.",
            "**effectiveSlaDomainId**: The ID of the SLA Domain that controls the protection of the Rubrik object.",
            "**effectiveSlaDomainName**: The name of the SLA Domain that controls the protection of the Rubrik object.",
            "**effectiveSlaDomainPolarisManagedId**: Optional. This field contains the managed ID of of the Polaris-managed effective SLA Domain.",
            "**effectiveSlaSourceObjectId**: The ID of the parent of the Rubrik object from which the SLA Domain that controls the protection of Rubrik object is inherited.",
            "**effectiveSlaSourceObjectName**: The name of the parent of the Rubrik object from which the SLA Domain that controls the protection of Rubrik object is inherited.",
            "**isEffectiveSlaDomainRetentionLocked**: Indicates whether the effective SLA Domain is Retention Locked. When this value is 'true', the effective SLA domain is a Retention Lock SLA Domain.",
            "**retentionSlaDomainId**: The ID of the SLA Domain whose retention policy is in use.",
            "**slaAssignment**: The SLA assignment type. Direct SLA assignment means that a SLA Domain was configured directly on the Rubrik object by the user. Derived SLA assignment means that the Rubrik object inherits an SLA Domain from its parent Rubrik object.",
            "**availabilityGroupId**: For an availability database, the ID of the availability group that the database belongs to.",
            "**copyOnly**: Boolean value that specifies whether or not to perform copy-only backups of the database. When true, database backups are copy-only backups. When false, database backups are full backups.",
            [
              "**currentBackupTaskInfo**",
              {
                "$ul": [
                  "**expectedEndTime**: The expected completion time of the task.",
                  "**queueTime**: The scheduled start time of the task.",
                  "**taskStatus**: Status of the task."
                ]
              }
            ],
            "**hasPermissions**: A Boolean value that specifies whether the cluster has permission to back up the database. When this value is 'true', the cluster has permission to back up the database.",
            "**includeBackupTaskInfo**: True/false value indicating if backup task information is included in the response.",
            "**instanceId**: This field is deprecated. Use the instanceId field on the replicas list instead. This field will continue to work for non-availability databases, but it is meaningless for availability databases.",
            "**instanceName**: This field is deprecated. Use the instanceName field on the replicas list instead. This field will continue to work for non-availability databases, but it is meaningless for availability databases.",
            "**isInAvailabilityGroup**",
            "**isLiveMount**: Boolean value that specifies whether a database object is a Live Mount. Value is 'true' when the database object is a Live Mount.",
            "**isLogShippingSecondary**: Boolean value that specifies whether a database object represents a secondary database. Value is 'true' when the database object represents a secondary database in a log shipping configuration.",
            "**isOnline**: A Boolean value that specifies whether the database is in the ONLINE state. When this value is 'true', the database is in the ONLINE state.",
            "**isRelic**",
            "**lastSnapshotTime**: The timestamp of the previous snapshot.. Only available in the /v1/mssql/db endpoint request body. The information will not be available for other endpoints.",
            "**logBackupFrequencyInSeconds**",
            "**logBackupRetentionHours**: Hours to keep a log backup. A value of -1 indicates that a log will only expire when the preceding snapshots have expired.",
            "**numMissedSnapshot**: An integer that specifies the number of missed snapshots. Only available in the /v1/mssql/db endpoint request body. The information will not be available for other endpoints.",
            [
              "**pendingSlaDomain**",
              {
                "$ul": [
                  "**isPendingSlaDomainRetentionLocked**",
                  "**objectId**: Managed ID of the object.",
                  "**pendingSlaDomainId**",
                  "**pendingSlaDomainName**"
                ]
              }
            ],
            "**recoveryModel**: This field is deprecated. Use the recoveryModel field on the replicas list instead. This field will continue to work for non-availability databases, but it is meaningless for availability databases.",
            "**replicas**: List of replicas of this database. An availability database may have multiple replicas, while other databases will have only one replica.",
            [
              "**rootProperties**",
              {
                "$ul": [
                  "**rootId**: ID of the root of this object.",
                  "**rootName**: Name of the root of this object.",
                  "**rootRole**: Role of the root object for this object if the root object is a Host and part of a **_MssqlAvailabilityGroup_**.",
                  "**rootType**: Type of the root object for this object. The root object is the top-level object from which this object is derived. If this object is an availability database, the root object is **_MssqlAvailabilityGroup_**. Otherwise, if this object is part of a cluster, the root object is **_WindowsCluster_**. Otherwise, the root object is **_Host_**."
                ]
              }
            ],
            "**state**: This field is deprecated. Use the state field on the replicas list instead. This field will continue to work for non-availability databases, but it is meaningless for availability databases.",
            "**unprotectableReasons**: A list of reasons that a SQL Server database cannot be protected by the Rubrik CDM.",
            [
              "**blackoutWindowStatus**",
              {
                "$ul": [
                  "**isGlobalBlackoutActive**",
                  "**isSnappableBlackoutActive**"
                ]
              }
            ],
            [
              "**blackoutWindows**",
              {
                "$ul": [
                  "**globalBlackoutWindows**",
                  "**snappableBlackoutWindows**"
                ]
              }
            ],
            "**archiveStorage**",
            "**isLocal**",
            "**isStandby**: This field is deprecated. Use the isStandby field on the replicas list instead. This field will continue to work for non-availability databases, but it is meaningless for availability databases.",
            "**latestRecoveryPoint**",
            "**localStorage**",
            "**maxDataStreams**",
            "**oldestRecoveryPoint**",
            [
              "**postBackupScript**",
              {
                "$ul": [
                  "**scriptErrorAction**: Action to take if the script returns an error or times out.",
                  "**scriptPath**: The script to be run.",
                  "**timeoutMs**: Time (in ms) after which the script will be terminated if it has not completed."
                ]
              }
            ],
            [
              "**preBackupScript**",
              {
                "$ul": [
                  "**scriptErrorAction**: Action to take if the script returns an error or times out.",
                  "**scriptPath**: The script to be run.",
                  "**timeoutMs**: Time (in ms) after which the script will be terminated if it has not completed."
                ]
              }
            ],
            "**protectionDate**",
            "**recoveryForkGuid**: This field is deprecated. Use the recoveryForkGuid field on the replicas list instead. This field will continue to work for non-availability databases, but it is meaningless for availability databases.",
            "**snapshotCount**"
          ]
        },
        {
          "$each": "$.body.*",
          "$as": "item",
          "$block": [
            {
              "$h2": {
                "$": "$.item.name"
              }
            },
            {
              "$lang": "json",
              "$code": {
                "$encode": "json",
                "$indent": true,
                "$content": {
                  "$": "$.item"
                }
              }
            }
          ]
        }
      ]
    }
  }
}
