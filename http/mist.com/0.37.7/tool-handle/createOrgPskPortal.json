{
  "name": "createOrgPskPortal",
  "description": "Create Org Psk Portal",
  "parameters": {
    "type": "object",
    "properties": {
      "org_id": {
        "example": "000000ab-00ab-00ab-00ab-0000000000ab",
        "format": "uuid",
        "type": "string"
      },
      "body": {
        "$ref": "#/$defs/psk_portal"
      }
    },
    "required": [
      "org_id"
    ],
    "$defs": {
      "psk_portal": {
        "properties": {
          "auth": {
            "default": "sso",
            "description": "Note: `sponsor` not yet available",
            "enum": [
              "sso",
              "sponsor"
            ],
            "type": "string"
          },
          "bg_image_url": {
            "type": "string"
          },
          "cleanup_psk": {
            "default": false,
            "description": "used to cleanup exited psk when portal delete or ssid changed",
            "type": "boolean"
          },
          "created_time": {
            "readOnly": true,
            "type": "integer"
          },
          "expire_time": {
            "description": "unit min",
            "type": "integer"
          },
          "expiry_notification_time": {
            "description": "Number of days before psk is expired. Used as to when to start sending reminder notification when the psk is about to expire",
            "type": "integer"
          },
          "hide_psks_created_by_other_admins": {
            "default": false,
            "description": "only if `type`==`admin`",
            "type": "boolean"
          },
          "id": {
            "readOnly": true,
            "type": "string"
          },
          "max_usage": {
            "default": 0,
            "description": "`max_usage`==`0` means unlimited",
            "type": "integer"
          },
          "modified_time": {
            "readOnly": true,
            "type": "integer"
          },
          "name": {
            "type": "string"
          },
          "notify_expiry": {
            "description": "If set to true, reminder notification will be sent when psk is about to expire",
            "type": "boolean"
          },
          "notify_on_create_or_edit": {
            "default": false,
            "type": "boolean"
          },
          "org_id": {
            "readOnly": true,
            "type": "string"
          },
          "passphrase_rules": {
            "properties": {
              "alphaberts_enabled": {
                "default": true,
                "type": "boolean"
              },
              "length": {
                "maximum": 63,
                "minimum": 8,
                "type": "integer"
              },
              "max_length": {
                "description": "for valid `max_length` and `min_length`, passphrase size is set randomly from that range.\n- if `max_length` and/or `min_length` are invalid, passphrase size is equal to `length` parameter\n- if `length` is not set or is invalid, default passphrase size is 8.\nvalid `max_length`, `min_length`, `length` should be an integer between 8 to 63. Also, `max_length` > `min_length`",
                "maximum": 63,
                "minimum": 8,
                "type": "integer"
              },
              "min_length": {
                "description": "for valid `max_length` and `min_length`, passphrase size is set randomly from that range.\n- if `max_length` and/or `min_length` are invalid, passphrase size is equal to `length` parameter\n- if `length` is not set or is invalid, default passphrase size is 8.\nvalid `max_length`, `min_length`, `length` should be an integer between 8 to 63. Also, `max_length` > `min_length`",
                "maximum": 63,
                "minimum": 8,
                "type": "integer"
              },
              "numerics_enabled": {
                "default": true,
                "type": "boolean"
              },
              "symbols": {
                "example": "()[]{}_%@#&$",
                "type": "string"
              },
              "symbols_enabled": {
                "default": true,
                "type": "boolean"
              }
            },
            "type": "object"
          },
          "required_fields": {
            "description": "what information to ask for (email is required by default)",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "role": {
            "type": "string"
          },
          "ssid": {
            "description": "intended SSID",
            "type": "string"
          },
          "sso": {
            "description": "if `auth`==`sso`",
            "properties": {
              "allowed_roles": {
                "description": "// allowed roles for accessing psk portal, if none, any role is permitted",
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "idp_cert": {
                "type": "string"
              },
              "idp_sign_algo": {
                "type": "string"
              },
              "idp_sso_url": {
                "type": "string"
              },
              "issuer": {
                "type": "string"
              },
              "nameid_format": {
                "type": "string"
              },
              "role_mapping": {
                "additionalProperties": {
                  "type": "string"
                },
                "description": "Property key is the role name, property value is the SSO Attribute",
                "type": "object"
              },
              "use_sso_role_for_psk_role": {
                "description": "if enabled, the `role` above will be ignored",
                "type": "boolean"
              }
            },
            "type": "object"
          },
          "template_url": {
            "description": "UI customization",
            "type": "string"
          },
          "thumbnail_url": {
            "type": "string"
          },
          "type": {
            "description": "for personal psk portal",
            "enum": [
              "byod",
              "admin"
            ],
            "type": "string"
          },
          "vlan_id": {
            "type": "integer"
          }
        },
        "required": [
          "name",
          "ssid"
        ],
        "type": "object",
        "x-examples": {
          "example-1": {
            "auth": "sso",
            "expire": 1440,
            "max_usage": 20,
            "name": "get-wifi",
            "required_fields": [
              "name"
            ],
            "role": "",
            "ssid": "Corp",
            "sso": {
              "default_role": "guest",
              "forced_role": "desired",
              "idp_cert": "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
              "idp_sign_algo": "sha256",
              "idp_sso_url": "https://yourorg.onelogin.com/trust/saml2/http-post/sso/138130",
              "issuer": "https://app.onelogin.com/saml/metadata/138130",
              "nameid_format": "email"
            },
            "sso_required_role": "Admin",
            "template_url": "",
            "type": "admin",
            "vlan_id": 417
          }
        }
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://api.mist.com/api/v1/orgs/{org_id}/pskportals"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**auth**: Note: `sponsor` not yet available (default: sso)",
            "**bg_image_url**",
            "**cleanup_psk**: used to cleanup exited psk when portal delete or ssid changed (default: false)",
            "**created_time**",
            "**expire_time**: unit min",
            "**expiry_notification_time**: Number of days before psk is expired. Used as to when to start sending reminder notification when the psk is about to expire",
            "**hide_psks_created_by_other_admins**: only if `type`==`admin` (default: false)",
            "**id**",
            "**max_usage**: `max_usage`==`0` means unlimited (default: 0)",
            "**modified_time**",
            "**name**",
            "**notify_expiry**: If set to true, reminder notification will be sent when psk is about to expire",
            "**notify_on_create_or_edit** (default: false)",
            "**org_id**",
            [
              "**passphrase_rules**",
              {
                "$ul": [
                  "**alphaberts_enabled** (default: true)",
                  "**length**",
                  "**max_length**: for valid `max_length` and `min_length`, passphrase size is set randomly from that range.",
                  "**min_length**: for valid `max_length` and `min_length`, passphrase size is set randomly from that range.",
                  "**numerics_enabled** (default: true)",
                  "**symbols**",
                  "**symbols_enabled** (default: true)"
                ]
              }
            ],
            "**required_fields**: what information to ask for (email is required by default)",
            "**role**",
            "**ssid**: intended SSID",
            [
              "**sso**: if `auth`==`sso`",
              {
                "$ul": [
                  "**allowed_roles**: // allowed roles for accessing psk portal, if none, any role is permitted",
                  "**idp_cert**",
                  "**idp_sign_algo**",
                  "**idp_sso_url**",
                  "**issuer**",
                  "**nameid_format**",
                  "**role_mapping**: Property key is the role name, property value is the SSO Attribute",
                  "**use_sso_role_for_psk_role**: if enabled, the `role` above will be ignored"
                ]
              }
            ],
            "**template_url**: UI customization",
            "**thumbnail_url**",
            "**type**: for personal psk portal",
            "**vlan_id**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "400": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "401": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**detail**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "403": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**detail**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "404": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**detail**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
