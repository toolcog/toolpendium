{
  "name": "occupancyAlerts",
  "description": "Webhook sample for `occupancy_alerts` topic\n\n**Note**: The server host will be your own server FQDN where the Mist Cloud is sending the webhook messages\n",
  "parameters": {
    "type": "object",
    "properties": {
      "body": {
        "$ref": "#/$defs/webhook_occupancy_alerts"
      }
    },
    "$defs": {
      "webhook_occupancy_alerts": {
        "description": "occupancy alert  webhook",
        "properties": {
          "events": {
            "items": {
              "properties": {
                "alert_events": {
                  "description": "list of occupancy alerts for non-compliance zones within the site detected around the same time",
                  "items": {
                    "properties": {
                      "current_occupancy": {
                        "type": "integer"
                      },
                      "map_id": {
                        "format": "uuid",
                        "type": "string"
                      },
                      "occupancy_limit": {
                        "type": "integer"
                      },
                      "org_id": {
                        "format": "uuid",
                        "type": "string"
                      },
                      "timestamp": {
                        "type": "number"
                      },
                      "type": {
                        "description": "event type (COMPLIANCE-VIOLATION / COMPLIANCE-OK)",
                        "enum": [
                          "COMPLIANCE-VIOLATION",
                          "COMPLIANCE-OK"
                        ],
                        "type": "string"
                      },
                      "zone_id": {
                        "format": "uuid",
                        "type": "string"
                      },
                      "zone_name": {
                        "type": "string"
                      }
                    },
                    "required": [
                      "current_occupancy",
                      "map_id",
                      "occupancy_limit",
                      "org_id",
                      "timestamp",
                      "type",
                      "zone_id",
                      "zone_name"
                    ],
                    "type": "object"
                  },
                  "minItems": 1,
                  "readOnly": true,
                  "type": "array",
                  "uniqueItems": true
                },
                "for_site": {
                  "readOnly": true,
                  "type": "boolean"
                },
                "site_id": {
                  "format": "uuid",
                  "readOnly": true,
                  "type": "string"
                },
                "site_name": {
                  "readOnly": true,
                  "type": "string"
                }
              },
              "required": [
                "site_id",
                "site_name"
              ],
              "type": "object"
            },
            "minItems": 1,
            "type": "array",
            "uniqueItems": true
          },
          "topic": {
            "default": "occupancy-alerts",
            "type": "string"
          }
        },
        "required": [
          "events",
          "topic"
        ],
        "type": "object",
        "x-examples": {
          "example-1": {
            "events": [
              {
                "alert_events": [
                  {
                    "current_occupancy": 10,
                    "map_id": "f5d26c7f-1670-4921-a79d-09f887f46b44",
                    "occupancy_limit": 5,
                    "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
                    "timestamp": 1594861457,
                    "type": "COMPLIANCE-VIOLATION",
                    "zone_id": "b83312a7-7269-4ae1-bea8-e7cfe0e3073c",
                    "zone_name": "PLM and Leadership"
                  },
                  {
                    "current_occupancy": 20,
                    "map_id": "f5d26c7f-1670-4921-a79d-09f887f46b44",
                    "occupancy_limit": 10,
                    "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
                    "timestamp": 1594861457,
                    "type": "COMPLIANCE-VIOLATION",
                    "zone_id": "80acf542-e863-43cf-9efd-9295468585e7",
                    "zone_name": "CSQA"
                  },
                  {
                    "current_occupancy": 9,
                    "map_id": "f5d26c7f-1670-4921-a79d-09f887f46b44",
                    "occupancy_limit": 4,
                    "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
                    "timestamp": 1594861457,
                    "type": "COMPLIANCE-VIOLATION",
                    "zone_id": "a4c7a7c2-880e-4a0e-9626-02e5a9471f86",
                    "zone_name": "Marketing & Sales Ops"
                  }
                ],
                "site_id": "67970e46-4e12-11e6-9188-0242ac110007",
                "site_name": "TRUE MIST OFFICE [STAGING]"
              }
            ],
            "topic": "occupancy-alerts"
          }
        },
        "x-stoplight": {
          "id": "f7a3f8bedd649"
        }
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://api.mist.com/webhook_example/_occupancy_alerts_"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
