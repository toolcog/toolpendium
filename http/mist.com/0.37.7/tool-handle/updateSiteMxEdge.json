{
  "name": "updateSiteMxEdge",
  "description": "Update Site Mist Edge settings",
  "parameters": {
    "type": "object",
    "properties": {
      "site_id": {
        "example": "000000ab-00ab-00ab-00ab-0000000000ab",
        "format": "uuid",
        "type": "string"
      },
      "mxedge_id": {
        "example": "000000ab-00ab-00ab-00ab-0000000000ab",
        "format": "uuid",
        "type": "string"
      },
      "body": {
        "$ref": "#/$defs/mxedge"
      }
    },
    "required": [
      "site_id",
      "mxedge_id"
    ],
    "$defs": {
      "mxedge": {
        "description": "MxEdge",
        "properties": {
          "created_time": {
            "readOnly": true,
            "type": "number"
          },
          "for_site": {
            "readOnly": true,
            "type": "boolean"
          },
          "id": {
            "example": "95ddd29a-6a3c-929e-a431-51a5b09f36a6",
            "format": "uuid",
            "readOnly": true,
            "type": "string"
          },
          "magic": {
            "example": "L-NpT5gi-ADR8WTFd4EiQPY3cP5WdSoD",
            "readOnly": true,
            "type": "string"
          },
          "model": {
            "example": "ME-100",
            "type": "string"
          },
          "modified_time": {
            "readOnly": true,
            "type": "number"
          },
          "mxagent_registered": {
            "readOnly": true,
            "type": "boolean"
          },
          "mxcluster_id": {
            "description": "MxCluster this MxEdge belongs to",
            "example": "572586b7-f97b-a22b-526c-8b97a3f609c4",
            "format": "uuid",
            "type": "string"
          },
          "mxedge_mgmt": {
            "properties": {
              "mist_password": {
                "example": "MIST_PASSWORD",
                "type": "string"
              },
              "root_password": {
                "example": "ROOT_PASSWORD",
                "type": "string"
              }
            },
            "type": "object"
          },
          "name": {
            "example": "Guest",
            "type": "string"
          },
          "ntp_servers": {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "oob_ip_config": {
            "description": "ip configuration of the Mist Edge out-of-band management interface",
            "properties": {
              "dns": {
                "default": [
                  "8.8.8.8",
                  "8.8.4.4"
                ],
                "description": "if `type`=`static`",
                "items": {
                  "example": "\"8.8.8.8\"",
                  "type": "string"
                },
                "type": "array"
              },
              "gateway": {
                "description": "if `type`=`static`",
                "example": "10.2.1.254",
                "type": "string"
              },
              "ip": {
                "description": "if `type`=`static`",
                "example": "10.2.1.2",
                "type": "string"
              },
              "netmask": {
                "description": "if `type`=`static`",
                "example": "255.255.255.0",
                "type": "string"
              },
              "type": {
                "default": "dhcp",
                "enum": [
                  "static",
                  "dhcp"
                ],
                "example": "static",
                "type": "string"
              }
            },
            "type": "object"
          },
          "org_id": {
            "format": "uuid",
            "readOnly": true,
            "type": "string"
          },
          "proxy": {
            "properties": {
              "url": {
                "description": "Proxy Configuration to talk to Mist",
                "example": "http://proxy.internal:8080/",
                "type": "string"
              }
            },
            "type": "object"
          },
          "services": {
            "description": "list of services to run, tunterm only for now",
            "items": {
              "default": "tunterm",
              "type": "string"
            },
            "type": "array"
          },
          "site_id": {
            "format": "uuid",
            "readOnly": true,
            "type": "string"
          },
          "tunterm_dhcpd_config": {
            "additionalProperties": {
              "properties": {
                "enabled": {
                  "default": false,
                  "type": "boolean"
                },
                "servers": {
                  "description": "list of DHCP servers; required if `type`==`relay`",
                  "items": {
                    "type": "string"
                  },
                  "type": "array"
                },
                "type": {
                  "default": "relay",
                  "enum": [
                    "relay"
                  ],
                  "type": "string"
                }
              },
              "type": "object"
            },
            "description": "global and per-VLAN. The property key is the VLAN ID",
            "properties": {
              "enabled": {
                "default": false,
                "type": "boolean"
              },
              "servers": {
                "description": "list of DHCP servers; required if `type`==`relay`",
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "type": {
                "default": "relay",
                "enum": [
                  "relay"
                ],
                "type": "string"
              }
            },
            "type": "object"
          },
          "tunterm_extra_routes": {
            "additionalProperties": {
              "properties": {
                "via": {
                  "type": "string"
                }
              },
              "type": "object"
            },
            "description": "The property key is a CIDR",
            "type": "object"
          },
          "tunterm_igmp_snooping_config": {
            "properties": {
              "enabled": {
                "default": false,
                "type": "boolean"
              },
              "querier": {
                "properties": {
                  "max_response_time": {
                    "description": "querier’s query response interval, in tenths-of-seconds",
                    "example": 10,
                    "type": "integer"
                  },
                  "mtu": {
                    "description": "the MTU we use (needed when forming large IGMPv3 Reports)",
                    "example": 1500,
                    "type": "integer"
                  },
                  "query_interval": {
                    "description": "querier’s query interval, in seconds",
                    "example": 125,
                    "type": "integer"
                  },
                  "robustness": {
                    "description": "querier’s robustness ",
                    "maximum": 7,
                    "minimum": 1,
                    "type": "integer"
                  },
                  "version": {
                    "description": "querier’s maximum protocol version",
                    "example": 3,
                    "type": "integer"
                  }
                },
                "type": "object"
              },
              "vlan_ids": {
                "description": "the list of vlans on which tunterm performs IGMP snooping",
                "items": {
                  "example": 2,
                  "type": "integer"
                },
                "type": "array"
              }
            },
            "type": "object"
          },
          "tunterm_ip_config": {
            "description": "ip configuration of the Mist Tunnel interface",
            "properties": {
              "gateway": {
                "example": "10.2.1.254",
                "type": "string"
              },
              "ip": {
                "description": "untagged VLAN",
                "example": "10.2.1.1",
                "type": "string"
              },
              "netmask": {
                "example": "255.255.255.0",
                "type": "string"
              }
            },
            "required": [
              "gateway",
              "ip",
              "netmask"
            ],
            "type": "object"
          },
          "tunterm_monitoring": {
            "items": {
              "$ref": "#/$defs/site_tunterm_monitoring"
            },
            "type": "array"
          },
          "tunterm_other_ip_configs": {
            "additionalProperties": {
              "properties": {
                "ip": {
                  "type": "string"
                },
                "netmask": {
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "netmask"
              ],
              "type": "object"
            },
            "description": "ip configs by VLAN ID. The property key is the VLAN ID",
            "type": "object"
          },
          "tunterm_port_config": {
            "description": "ethernet port configurations",
            "properties": {
              "downstream_ports": {
                "description": "list of ports to be used for downstream (to AP) purpose",
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "separate_upstream_downstream": {
                "default": false,
                "description": "weather to separate upstream / downstream ports. default is false where all ports will be used.",
                "type": "boolean"
              },
              "upstream_port_vlan_id": {
                "default": 1,
                "description": "native VLAN id for upstream ports",
                "example": 30,
                "type": "integer"
              },
              "upstream_ports": {
                "description": "list of ports to be used for upstrea purpose (to LAN)",
                "items": {
                  "type": "string"
                },
                "type": "array"
              }
            },
            "type": "object"
          },
          "tunterm_registered": {
            "readOnly": true,
            "type": "boolean"
          },
          "tunterm_switch_config": {
            "additionalProperties": {
              "properties": {
                "port_vlan_id": {
                  "type": "integer"
                },
                "vlan_ids": {
                  "items": {
                    "anyOf": [
                      {
                        "type": "integer"
                      },
                      {
                        "type": "string"
                      }
                    ]
                  },
                  "type": "array"
                }
              },
              "type": "object"
            },
            "description": "if custom vlan settings are desired",
            "properties": {
              "enabled": {
                "type": "boolean"
              }
            },
            "type": "object"
          },
          "versions": {
            "properties": {
              "mxagent": {
                "type": "string"
              },
              "tuntnerm": {
                "type": "string"
              }
            },
            "type": "object"
          }
        },
        "required": [
          "model",
          "name"
        ],
        "type": "object",
        "x-examples": {
          "Example 1": {
            "created_time": 0,
            "for_site": true,
            "id": "95ddd29a-6a3c-929e-a431-51a5b09f36a6",
            "magic": "L-NpT5gi-ADR8WTFd4EiQPY3cP5WdSoD",
            "model": "ME-100",
            "modified_time": 0,
            "mxagent_registered": true,
            "mxcluster_id": "572586b7-f97b-a22b-526c-8b97a3f609c4",
            "mxedge_mgmt": {
              "mist_password": "MIST_PASSWORD",
              "root_password": "ROOT_PASSWORD"
            },
            "name": "Guest",
            "ntp_servers": [
              "string"
            ],
            "oob_ip_config": {
              "dns": [
                "8.8.8.8",
                "8.8.4.4"
              ],
              "gateway": "10.2.1.254",
              "ip": "10.2.1.2",
              "netmask": "255.255.255.0",
              "type": "dhcp"
            },
            "org_id": "a40f5d1f-d889-42e9-94ea-b9b33585fc6b",
            "proxy": {
              "url": "http://proxy.internal:8080/"
            },
            "services": [
              "tunterm"
            ],
            "site_id": "72771e6a-6f5e-4de4-a5b9-1266c4197811",
            "tunterm_dhcpd_config": {
              "enabled": false,
              "property1": {
                "enabled": false,
                "servers": [
                  "string"
                ],
                "type": "relay"
              },
              "property2": {
                "enabled": false,
                "servers": [
                  "string"
                ],
                "type": "relay"
              },
              "servers": [
                "string"
              ],
              "type": "relay"
            },
            "tunterm_extra_routes": {
              "property1": {
                "via": "string"
              },
              "property2": {
                "via": "string"
              }
            },
            "tunterm_igmp_snooping_config": {
              "enabled": false,
              "querier": {
                "max_response_time": 10,
                "mtu": 1500,
                "query_interval": 125,
                "robustness": 1,
                "version": 3
              },
              "vlan_ids": [
                2
              ]
            },
            "tunterm_ip_config": {
              "gateway": "10.2.1.254",
              "ip": "10.2.1.1",
              "netmask": "255.255.255.0"
            },
            "tunterm_monitoring": [
              {
                "host": "10.2.8.15",
                "port": 80,
                "protocol": "tcp",
                "timeout": 300
              }
            ],
            "tunterm_other_ip_configs": {
              "property1": {
                "ip": "string",
                "netmask": "string"
              },
              "property2": {
                "ip": "string",
                "netmask": "string"
              }
            },
            "tunterm_port_config": {
              "downstream_ports": [
                "3"
              ],
              "separate_upstream_downstream": false,
              "upstream_port_vlan_id": 1,
              "upstream_ports": [
                "0"
              ]
            },
            "tunterm_registered": true,
            "tunterm_switch_config": {
              "enabled": true,
              "property1": {
                "port_vlan_id": 0,
                "vlan_ids": [
                  0
                ]
              },
              "property2": {
                "port_vlan_id": 0,
                "vlan_ids": [
                  0
                ]
              }
            },
            "versions": {
              "mxagent": "string",
              "tuntnerm": "string"
            }
          }
        }
      },
      "site_tunterm_monitoring": {
        "properties": {
          "host": {
            "description": "can be ip, ipv6, hostname",
            "example": "10.2.8.15",
            "minLength": 1,
            "type": "string"
          },
          "port": {
            "description": "when `protocol`==`tcp`",
            "example": 80,
            "type": "integer"
          },
          "protocol": {
            "enum": [
              "arp",
              "ping",
              "tcp"
            ],
            "example": "tcp",
            "minLength": 1,
            "type": "string"
          },
          "timeout": {
            "default": 300,
            "example": 300,
            "type": "integer"
          }
        },
        "type": "object",
        "x-examples": {
          "example-1": {
            "host": "10.2.8.15",
            "port": 80,
            "protocol": "ping",
            "timeout": 300
          }
        }
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "PUT",
    "url": {
      "$uri": "https://api.mist.com/api/v1/sites/{site_id}/mxedges/{mxedge_id}"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "MxEdge",
        "**Key properties:**",
        {
          "$ul": [
            "**created_time**",
            "**for_site**",
            "**id**",
            "**magic**",
            "**model**",
            "**modified_time**",
            "**mxagent_registered**",
            "**mxcluster_id**: MxCluster this MxEdge belongs to",
            [
              "**mxedge_mgmt**",
              {
                "$ul": [
                  "**mist_password**",
                  "**root_password**"
                ]
              }
            ],
            "**name**",
            "**ntp_servers**",
            [
              "**oob_ip_config**: ip configuration of the Mist Edge out-of-band management interface",
              {
                "$ul": [
                  "**dns**: if `type`=`static` (default: 8.8.8.8,8.8.4.4)",
                  "**gateway**: if `type`=`static`",
                  "**ip**: if `type`=`static`",
                  "**netmask**: if `type`=`static`",
                  "**type** (default: dhcp)"
                ]
              }
            ],
            "**org_id**",
            [
              "**proxy**",
              {
                "$ul": [
                  "**url**: Proxy Configuration to talk to Mist"
                ]
              }
            ],
            "**services**: list of services to run, tunterm only for now",
            "**site_id**",
            [
              "**tunterm_dhcpd_config**: global and per-VLAN. The property key is the VLAN ID",
              {
                "$ul": [
                  "**enabled** (default: false)",
                  "**servers**: list of DHCP servers; required if `type`==`relay`",
                  "**type** (default: relay)"
                ]
              }
            ],
            "**tunterm_extra_routes**: The property key is a CIDR",
            [
              "**tunterm_igmp_snooping_config**",
              {
                "$ul": [
                  "**enabled** (default: false)",
                  [
                    "**querier**",
                    {
                      "$ul": [
                        "**max_response_time**: querier’s query response interval, in tenths-of-seconds",
                        "**mtu**: the MTU we use (needed when forming large IGMPv3 Reports)",
                        "**query_interval**: querier’s query interval, in seconds",
                        "**robustness**: querier’s robustness ",
                        "**version**: querier’s maximum protocol version"
                      ]
                    }
                  ],
                  "**vlan_ids**: the list of vlans on which tunterm performs IGMP snooping"
                ]
              }
            ],
            [
              "**tunterm_ip_config**: ip configuration of the Mist Tunnel interface",
              {
                "$ul": [
                  "**gateway**",
                  "**ip**: untagged VLAN",
                  "**netmask**"
                ]
              }
            ],
            "**tunterm_monitoring**",
            "**tunterm_other_ip_configs**: ip configs by VLAN ID. The property key is the VLAN ID",
            [
              "**tunterm_port_config**: ethernet port configurations",
              {
                "$ul": [
                  "**downstream_ports**: list of ports to be used for downstream (to AP) purpose",
                  "**separate_upstream_downstream**: weather to separate upstream / downstream ports. default is false where all ports will be used. (default: false)",
                  "**upstream_port_vlan_id**: native VLAN id for upstream ports (default: 1)",
                  "**upstream_ports**: list of ports to be used for upstrea purpose (to LAN)"
                ]
              }
            ],
            "**tunterm_registered**",
            [
              "**tunterm_switch_config**: if custom vlan settings are desired",
              {
                "$ul": [
                  "**enabled**"
                ]
              }
            ],
            [
              "**versions**",
              {
                "$ul": [
                  "**mxagent**",
                  "**tuntnerm**"
                ]
              }
            ]
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "400": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "401": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**detail**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "403": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**detail**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "404": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**detail**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
