{
  "name": "createNetworkSwitchAccessPolicy",
  "description": "Create an access policy for a switch network. If you would like to enable Meraki Authentication, set radiusServers to empty array.",
  "parameters": {
    "type": "object",
    "properties": {
      "networkId": {
        "type": "string"
      },
      "body": {
        "example": {
          "accessPolicyType": "Hybrid authentication",
          "dot1x": {
            "controlDirection": "inbound"
          },
          "guestPortBouncing": false,
          "guestVlanId": 100,
          "hostMode": "Single-Host",
          "increaseAccessSpeed": false,
          "name": "Access policy #1",
          "radius": {
            "criticalAuth": {
              "dataVlanId": 100,
              "suspendPortBounce": true,
              "voiceVlanId": 100
            },
            "failedAuthVlanId": 100,
            "reAuthenticationInterval": 120
          },
          "radiusAccountingEnabled": true,
          "radiusAccountingServers": [
            {
              "host": "1.2.3.4",
              "port": 22,
              "secret": "secret"
            }
          ],
          "radiusCoaSupportEnabled": false,
          "radiusGroupAttribute": "11",
          "radiusServers": [
            {
              "host": "1.2.3.4",
              "port": 22,
              "secret": "secret"
            }
          ],
          "radiusTestingEnabled": false,
          "urlRedirectWalledGardenEnabled": true,
          "urlRedirectWalledGardenRanges": [
            "192.168.1.0/24"
          ],
          "voiceVlanClients": true
        },
        "properties": {
          "accessPolicyType": {
            "description": "Access Type of the policy. Automatically 'Hybrid authentication' when hostMode is 'Multi-Domain'.",
            "enum": [
              "802.1x",
              "Hybrid authentication",
              "MAC authentication bypass"
            ],
            "type": "string"
          },
          "dot1x": {
            "description": "802.1x Settings",
            "properties": {
              "controlDirection": {
                "description": "Supports either 'both' or 'inbound'. Set to 'inbound' to allow unauthorized egress on the switchport. Set to 'both' to control both traffic directions with authorization. Defaults to 'both'",
                "enum": [
                  "both",
                  "inbound"
                ],
                "type": "string"
              }
            },
            "type": "object"
          },
          "guestPortBouncing": {
            "description": "If enabled, Meraki devices will periodically send access-request messages to these RADIUS servers",
            "type": "boolean"
          },
          "guestVlanId": {
            "description": "ID for the guest VLAN allow unauthorized devices access to limited network resources",
            "type": "integer"
          },
          "hostMode": {
            "description": "Choose the Host Mode for the access policy.",
            "enum": [
              "Multi-Auth",
              "Multi-Domain",
              "Multi-Host",
              "Single-Host"
            ],
            "type": "string"
          },
          "increaseAccessSpeed": {
            "description": "Enabling this option will make switches execute 802.1X and MAC-bypass authentication simultaneously so that clients authenticate faster. Only required when accessPolicyType is 'Hybrid Authentication.",
            "type": "boolean"
          },
          "name": {
            "description": "Name of the access policy",
            "type": "string"
          },
          "radius": {
            "description": "Object for RADIUS Settings",
            "properties": {
              "criticalAuth": {
                "description": "Critical auth settings for when authentication is rejected by the RADIUS server",
                "properties": {
                  "dataVlanId": {
                    "description": "VLAN that clients who use data will be placed on when RADIUS authentication fails. Will be null if hostMode is Multi-Auth",
                    "type": "integer"
                  },
                  "suspendPortBounce": {
                    "description": "Enable to suspend port bounce when RADIUS servers are unreachable",
                    "type": "boolean"
                  },
                  "voiceVlanId": {
                    "description": "VLAN that clients who use voice will be placed on when RADIUS authentication fails. Will be null if hostMode is Multi-Auth",
                    "type": "integer"
                  }
                },
                "type": "object"
              },
              "failedAuthVlanId": {
                "description": "VLAN that clients will be placed on when RADIUS authentication fails. Will be null if hostMode is Multi-Auth",
                "type": "integer"
              },
              "reAuthenticationInterval": {
                "description": "Re-authentication period in seconds. Will be null if hostMode is Multi-Auth",
                "type": "integer"
              }
            },
            "type": "object"
          },
          "radiusAccountingEnabled": {
            "description": "Enable to send start, interim-update and stop messages to a configured RADIUS accounting server for tracking connected clients",
            "type": "boolean"
          },
          "radiusAccountingServers": {
            "description": "List of RADIUS accounting servers to require connecting devices to authenticate against before granting network access",
            "items": {
              "properties": {
                "host": {
                  "description": "Public IP address of the RADIUS accounting server",
                  "type": "string"
                },
                "port": {
                  "description": "UDP port that the RADIUS Accounting server listens on for access requests",
                  "type": "integer"
                },
                "secret": {
                  "description": "RADIUS client shared secret",
                  "type": "string"
                }
              },
              "required": [
                "host",
                "port",
                "secret"
              ],
              "type": "object"
            },
            "type": "array"
          },
          "radiusCoaSupportEnabled": {
            "description": "Change of authentication for RADIUS re-authentication and disconnection",
            "type": "boolean"
          },
          "radiusGroupAttribute": {
            "description": "Acceptable values are `\"\"` for None, or `\"11\"` for Group Policies ACL",
            "type": "string"
          },
          "radiusServers": {
            "description": "List of RADIUS servers to require connecting devices to authenticate against before granting network access",
            "items": {
              "properties": {
                "host": {
                  "description": "Public IP address of the RADIUS server",
                  "type": "string"
                },
                "port": {
                  "description": "UDP port that the RADIUS server listens on for access requests",
                  "type": "integer"
                },
                "secret": {
                  "description": "RADIUS client shared secret",
                  "type": "string"
                }
              },
              "required": [
                "host",
                "port",
                "secret"
              ],
              "type": "object"
            },
            "type": "array"
          },
          "radiusTestingEnabled": {
            "description": "If enabled, Meraki devices will periodically send access-request messages to these RADIUS servers",
            "type": "boolean"
          },
          "urlRedirectWalledGardenEnabled": {
            "description": "Enable to restrict access for clients to a specific set of IP addresses or hostnames prior to authentication",
            "type": "boolean"
          },
          "urlRedirectWalledGardenRanges": {
            "description": "IP address ranges, in CIDR notation, to restrict access for clients to a specific set of IP addresses or hostnames prior to authentication",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "voiceVlanClients": {
            "description": "CDP/LLDP capable voice clients will be able to use this VLAN. Automatically true when hostMode is 'Multi-Domain'.",
            "type": "boolean"
          }
        },
        "required": [
          "name",
          "radiusServers",
          "radiusTestingEnabled",
          "radiusCoaSupportEnabled",
          "radiusAccountingEnabled",
          "hostMode",
          "urlRedirectWalledGardenEnabled"
        ],
        "type": "object"
      }
    },
    "required": [
      "networkId",
      "body"
    ]
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://api.meraki.com/api/v1/networks/{networkId}/switch/accessPolicies"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "201": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**accessPolicyType**: Access Type of the policy. Automatically 'Hybrid authentication' when hostMode is 'Multi-Domain'.",
            [
              "**dot1x**: 802.1x Settings",
              {
                "$ul": [
                  "**controlDirection**: Supports either 'both' or 'inbound'. Set to 'inbound' to allow unauthorized egress on the switchport. Set to 'both' to control both traffic directions with authorization. Defaults to 'both'"
                ]
              }
            ],
            "**guestPortBouncing**: If enabled, Meraki devices will periodically send access-request messages to these RADIUS servers",
            "**guestVlanId**: ID for the guest VLAN allow unauthorized devices access to limited network resources",
            "**hostMode**: Choose the Host Mode for the access policy.",
            "**increaseAccessSpeed**: Enabling this option will make switches execute 802.1X and MAC-bypass authentication simultaneously so that clients authenticate faster. Only required when accessPolicyType is 'Hybrid Authentication.",
            "**name**: Name of the access policy",
            [
              "**radius**: Object for RADIUS Settings",
              {
                "$ul": [
                  [
                    "**criticalAuth**: Critical auth settings for when authentication is rejected by the RADIUS server",
                    {
                      "$ul": [
                        "**dataVlanId**: VLAN that clients who use data will be placed on when RADIUS authentication fails. Will be null if hostMode is Multi-Auth",
                        "**suspendPortBounce**: Enable to suspend port bounce when RADIUS servers are unreachable",
                        "**voiceVlanId**: VLAN that clients who use voice will be placed on when RADIUS authentication fails. Will be null if hostMode is Multi-Auth"
                      ]
                    }
                  ],
                  "**failedAuthVlanId**: VLAN that clients will be placed on when RADIUS authentication fails. Will be null if hostMode is Multi-Auth",
                  "**reAuthenticationInterval**: Re-authentication period in seconds. Will be null if hostMode is Multi-Auth"
                ]
              }
            ],
            "**radiusAccountingEnabled**: Enable to send start, interim-update and stop messages to a configured RADIUS accounting server for tracking connected clients",
            "**radiusAccountingServers**: List of RADIUS accounting servers to require connecting devices to authenticate against before granting network access",
            "**radiusCoaSupportEnabled**: Change of authentication for RADIUS re-authentication and disconnection",
            "**radiusGroupAttribute**: Acceptable values are `\"\"` for None, or `\"11\"` for Group Policies ACL",
            "**radiusServers**: List of RADIUS servers to require connecting devices to authenticate against before granting network access",
            "**radiusTestingEnabled**: If enabled, Meraki devices will periodically send access-request messages to these RADIUS servers",
            "**urlRedirectWalledGardenEnabled**: Enable to restrict access for clients to a response_objectific set of IP addresses or hostnames prior to authentication",
            "**urlRedirectWalledGardenRanges**: IP address ranges, in CIDR notation, to restrict access for clients to a specific set of IP addresses or hostnames prior to authentication",
            "**voiceVlanClients**: CDP/LLDP capable voice clients will be able to use this VLAN. Automatically true when hostMode is 'Multi-Domain'."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
