{
  "name": "updateNetworkApplianceSecurityMalware",
  "description": "Set the supported malware settings for an MX network",
  "parameters": {
    "type": "object",
    "properties": {
      "networkId": {
        "type": "string"
      },
      "body": {
        "example": {
          "allowedFiles": [
            {
              "comment": "allow ZIP file",
              "sha256": "e82c5f7d75004727e1f3b94426b9a11c8bc4c312a9170ac9a73abace40aef503"
            }
          ],
          "allowedUrls": [
            {
              "comment": "allow example.org",
              "url": "example.org"
            },
            {
              "comment": "allow help.com.au",
              "url": "help.com.au"
            }
          ],
          "mode": "enabled"
        },
        "properties": {
          "allowedFiles": {
            "description": "The sha256 digests of files that should be permitted by the malware detection engine. If omitted, the current config will remain unchanged. This is available only if your network supports AMP allow listing",
            "items": {
              "properties": {
                "comment": {
                  "description": "Comment about the allowed entity",
                  "type": "string"
                },
                "sha256": {
                  "description": "The file sha256 hash to allow",
                  "type": "string"
                }
              },
              "required": [
                "sha256",
                "comment"
              ],
              "type": "object"
            },
            "type": "array"
          },
          "allowedUrls": {
            "description": "The urls that should be permitted by the malware detection engine. If omitted, the current config will remain unchanged. This is available only if your network supports AMP allow listing",
            "items": {
              "properties": {
                "comment": {
                  "description": "Comment about the allowed entity",
                  "type": "string"
                },
                "url": {
                  "description": "The url to allow",
                  "type": "string"
                }
              },
              "required": [
                "url",
                "comment"
              ],
              "type": "object"
            },
            "type": "array"
          },
          "mode": {
            "description": "Set mode to 'enabled' to enable malware prevention, otherwise 'disabled'",
            "enum": [
              "disabled",
              "enabled"
            ],
            "type": "string"
          }
        },
        "required": [
          "mode"
        ],
        "type": "object"
      }
    },
    "required": [
      "networkId",
      "body"
    ]
  },
  "handler": "http",
  "request": {
    "method": "PUT",
    "url": {
      "$uri": "https://api.meraki.com/api/v1/networks/{networkId}/appliance/security/malware"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
