{
  "name": "updateNetworkSecurityIntrusionSettings",
  "description": "Set the supported intrusion settings for an MX network",
  "parameters": {
    "type": "object",
    "properties": {
      "networkId": {
        "type": "string"
      },
      "body": {
        "example": {
          "idsRulesets": "balanced",
          "mode": "prevention",
          "protectedNetworks": {
            "excludedCidr": [
              "10.0.0.0/8",
              "127.0.0.0/8"
            ],
            "includedCidr": [
              "10.0.0.0/8",
              "127.0.0.0/8",
              "169.254.0.0/16",
              "172.16.0.0/12"
            ],
            "useDefault": false
          }
        },
        "properties": {
          "idsRulesets": {
            "description": "Set the detection ruleset 'connectivity'/'balanced'/'security' (optional - omitting will leave current config unchanged). Default value is 'balanced' if none currently saved",
            "enum": [
              "balanced",
              "connectivity",
              "security"
            ],
            "type": "string"
          },
          "mode": {
            "description": "Set mode to 'disabled'/'detection'/'prevention' (optional - omitting will leave current config unchanged)",
            "enum": [
              "detection",
              "disabled",
              "prevention"
            ],
            "type": "string"
          },
          "protectedNetworks": {
            "description": "Set the included/excluded networks from the intrusion engine (optional - omitting will leave current config unchanged). This is available only in 'passthrough' mode",
            "properties": {
              "excludedCidr": {
                "description": "list of IP addresses or subnets being excluded from protection (required if 'useDefault' is false)",
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "includedCidr": {
                "description": "list of IP addresses or subnets being protected (required if 'useDefault' is false)",
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "useDefault": {
                "description": "true/false whether to use special IPv4 addresses: https://tools.ietf.org/html/rfc5735 (required). Default value is true if none currently saved",
                "type": "boolean"
              }
            },
            "type": "object"
          }
        },
        "type": "object"
      }
    },
    "required": [
      "networkId"
    ]
  },
  "handler": "http",
  "request": {
    "method": "PUT",
    "url": {
      "$uri": "https://api.meraki.com/api/v0/networks/{networkId}/security/intrusionSettings"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
