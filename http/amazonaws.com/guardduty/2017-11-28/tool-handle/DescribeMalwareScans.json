{
  "name": "DescribeMalwareScans",
  "description": "<p>Returns a list of malware scans. Each member account can view the malware scans for their own accounts. An administrator can view the malware scans for all the member accounts.</p> <p>There might be regional differences because some data sources might not be available in all the Amazon Web Services Regions where GuardDuty is presently supported. For more information, see <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_regions.html\">Regions and endpoints</a>.</p>",
  "parameters": {
    "type": "object",
    "properties": {
      "detectorId": {
        "type": "string",
        "minLength": 1,
        "maxLength": 300,
        "description": "The unique ID of the detector that the request is associated with."
      },
      "MaxResults": {
        "type": "string",
        "description": "Pagination limit"
      },
      "NextToken": {
        "type": "string",
        "description": "Pagination token"
      },
      "X-Amz-Content-Sha256": {
        "type": "string"
      },
      "X-Amz-Date": {
        "type": "string"
      },
      "X-Amz-Algorithm": {
        "type": "string"
      },
      "X-Amz-Credential": {
        "type": "string"
      },
      "X-Amz-Security-Token": {
        "type": "string"
      },
      "X-Amz-Signature": {
        "type": "string"
      },
      "X-Amz-SignedHeaders": {
        "type": "string"
      },
      "body": {
        "type": "object",
        "properties": {
          "nextToken": {
            "description": "You can use this parameter when paginating results. Set the value of this parameter to null on your first call to the list action. For subsequent calls to the action, fill nextToken in the request with the value of NextToken from the previous response to continue listing data.",
            "type": "string"
          },
          "maxResults": {
            "description": "You can use this parameter to indicate the maximum number of items that you want in the response. The default value is 50. The maximum value is 50.",
            "type": "integer",
            "minimum": 1,
            "maximum": 50
          },
          "filterCriteria": {
            "description": "Represents the criteria to be used in the filter for describing scan entries.",
            "type": "object",
            "properties": {
              "FilterCriterion": {
                "allOf": [
                  {
                    "$ref": "#/$defs/FilterCriterionList"
                  },
                  {
                    "xml": {
                      "name": "filterCriterion"
                    },
                    "description": "Represents a condition that when matched will be added to the response of the operation."
                  }
                ]
              }
            }
          },
          "sortCriteria": {
            "description": "Contains information about the criteria used for sorting findings.",
            "type": "object",
            "properties": {
              "AttributeName": {
                "allOf": [
                  {
                    "$ref": "#/$defs/String"
                  },
                  {
                    "xml": {
                      "name": "attributeName"
                    },
                    "description": "Represents the finding attribute, such as <code>accountId</code>, that sorts the findings."
                  }
                ]
              },
              "OrderBy": {
                "allOf": [
                  {
                    "$ref": "#/$defs/OrderBy"
                  },
                  {
                    "xml": {
                      "name": "orderBy"
                    },
                    "description": "The order by which the sorted findings are to be displayed."
                  }
                ]
              }
            }
          }
        }
      }
    },
    "required": [
      "detectorId",
      "body"
    ],
    "$defs": {
      "FilterCriterionList": {
        "type": "array",
        "items": {
          "$ref": "#/$defs/FilterCriterion"
        },
        "minItems": 0,
        "maxItems": 1
      },
      "FilterCriterion": {
        "type": "object",
        "properties": {
          "CriterionKey": {
            "allOf": [
              {
                "$ref": "#/$defs/CriterionKey"
              },
              {
                "xml": {
                  "name": "criterionKey"
                },
                "description": "An enum value representing possible scan properties to match with given scan entries."
              }
            ]
          },
          "FilterCondition": {
            "allOf": [
              {
                "$ref": "#/$defs/FilterCondition"
              },
              {
                "xml": {
                  "name": "filterCondition"
                },
                "description": "Contains information about the condition."
              }
            ]
          }
        },
        "description": "Represents a condition that when matched will be added to the response of the operation. Irrespective of using any filter criteria, an administrator account can view the scan entries for all of its member accounts. However, each member account can view the scan entries only for their own account."
      },
      "CriterionKey": {
        "type": "string",
        "enum": [
          "EC2_INSTANCE_ARN",
          "SCAN_ID",
          "ACCOUNT_ID",
          "GUARDDUTY_FINDING_ID",
          "SCAN_START_TIME",
          "SCAN_STATUS",
          "SCAN_TYPE"
        ]
      },
      "FilterCondition": {
        "type": "object",
        "properties": {
          "EqualsValue": {
            "allOf": [
              {
                "$ref": "#/$defs/NonEmptyString"
              },
              {
                "xml": {
                  "name": "equalsValue"
                },
                "description": "Represents an <i>equal</i> <b/> condition to be applied to a single field when querying for scan entries."
              }
            ]
          },
          "GreaterThan": {
            "allOf": [
              {
                "$ref": "#/$defs/LongValue"
              },
              {
                "xml": {
                  "name": "greaterThan"
                },
                "description": "Represents a <i>greater than</i> condition to be applied to a single field when querying for scan entries."
              }
            ]
          },
          "LessThan": {
            "allOf": [
              {
                "$ref": "#/$defs/LongValue"
              },
              {
                "xml": {
                  "name": "lessThan"
                },
                "description": "Represents a <i>less than</i> condition to be applied to a single field when querying for scan entries."
              }
            ]
          }
        },
        "description": "Contains information about the condition."
      },
      "NonEmptyString": {
        "type": "string",
        "minLength": 1,
        "maxLength": 200
      },
      "LongValue": {
        "type": "integer"
      },
      "String": {
        "type": "string"
      },
      "OrderBy": {
        "type": "string",
        "enum": [
          "ASC",
          "DESC"
        ]
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "http://guardduty.us-east-1.amazonaws.com/detector/{detectorId}/malware-scans{?MaxResults,NextToken}"
    },
    "headers": {
      "X-Amz-Content-Sha256": {
        "$": "X-Amz-Content-Sha256"
      },
      "X-Amz-Date": {
        "$": "X-Amz-Date"
      },
      "X-Amz-Algorithm": {
        "$": "X-Amz-Algorithm"
      },
      "X-Amz-Credential": {
        "$": "X-Amz-Credential"
      },
      "X-Amz-Security-Token": {
        "$": "X-Amz-Security-Token"
      },
      "X-Amz-Signature": {
        "$": "X-Amz-Signature"
      },
      "X-Amz-SignedHeaders": {
        "$": "X-Amz-SignedHeaders"
      }
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**Scans**",
            "**NextToken**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "480": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "481": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    }
  }
}
