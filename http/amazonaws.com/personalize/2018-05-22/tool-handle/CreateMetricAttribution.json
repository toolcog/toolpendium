{
  "name": "CreateMetricAttribution",
  "description": "Creates a metric attribution. A metric attribution creates reports on the data that you import into Amazon Personalize. Depending on how you imported the data, you can view reports in Amazon CloudWatch or Amazon S3. For more information, see <a href=\"https://docs.aws.amazon.com/personalize/latest/dg/measuring-recommendation-impact.html\">Measuring impact of recommendations</a>.",
  "parameters": {
    "type": "object",
    "properties": {
      "X-Amz-Target": {
        "type": "string",
        "enum": [
          "AmazonPersonalize.CreateMetricAttribution"
        ]
      },
      "X-Amz-Content-Sha256": {
        "type": "string"
      },
      "X-Amz-Date": {
        "type": "string"
      },
      "X-Amz-Algorithm": {
        "type": "string"
      },
      "X-Amz-Credential": {
        "type": "string"
      },
      "X-Amz-Security-Token": {
        "type": "string"
      },
      "X-Amz-Signature": {
        "type": "string"
      },
      "X-Amz-SignedHeaders": {
        "type": "string"
      },
      "body": {
        "$ref": "#/$defs/CreateMetricAttributionRequest"
      }
    },
    "required": [
      "X-Amz-Target",
      "body"
    ],
    "$defs": {
      "CreateMetricAttributionRequest": {
        "type": "object",
        "required": [
          "name",
          "datasetGroupArn",
          "metrics",
          "metricsOutputConfig"
        ],
        "title": "CreateMetricAttributionRequest",
        "properties": {
          "name": {
            "allOf": [
              {
                "$ref": "#/$defs/Name"
              },
              {
                "description": "A name for the metric attribution."
              }
            ]
          },
          "datasetGroupArn": {
            "allOf": [
              {
                "$ref": "#/$defs/Arn"
              },
              {
                "description": "The Amazon Resource Name (ARN) of the destination dataset group for the metric attribution."
              }
            ]
          },
          "metrics": {
            "allOf": [
              {
                "$ref": "#/$defs/MetricAttributes"
              },
              {
                "description": "A list of metric attributes for the metric attribution. Each metric attribute specifies an event type to track and a function. Available functions are <code>SUM()</code> or <code>SAMPLECOUNT()</code>. For SUM() functions, provide the dataset type (either Interactions or Items) and column to sum as a parameter. For example SUM(Items.PRICE)."
              }
            ]
          },
          "metricsOutputConfig": {
            "allOf": [
              {
                "$ref": "#/$defs/MetricAttributionOutput"
              },
              {
                "description": "The output configuration details for the metric attribution."
              }
            ]
          }
        }
      },
      "Name": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9][a-zA-Z0-9\\-_]*",
        "minLength": 1,
        "maxLength": 63
      },
      "Arn": {
        "type": "string",
        "pattern": "arn:([a-z\\d-]+):personalize:.*:.*:.+",
        "maxLength": 256
      },
      "MetricAttributes": {
        "type": "array",
        "items": {
          "$ref": "#/$defs/MetricAttribute"
        },
        "maxItems": 10
      },
      "MetricAttribute": {
        "type": "object",
        "required": [
          "eventType",
          "metricName",
          "expression"
        ],
        "properties": {
          "eventType": {
            "allOf": [
              {
                "$ref": "#/$defs/EventType"
              },
              {
                "description": "The metric's event type."
              }
            ]
          },
          "metricName": {
            "allOf": [
              {
                "$ref": "#/$defs/MetricName"
              },
              {
                "description": "The metric's name. The name helps you identify the metric in Amazon CloudWatch or Amazon S3."
              }
            ]
          },
          "expression": {
            "allOf": [
              {
                "$ref": "#/$defs/MetricExpression"
              },
              {
                "description": "The attribute's expression. Available functions are <code>SUM()</code> or <code>SAMPLECOUNT()</code>. For SUM() functions, provide the dataset type (either Interactions or Items) and column to sum as a parameter. For example SUM(Items.PRICE)."
              }
            ]
          }
        },
        "description": "Contains information on a metric that a metric attribution reports on. For more information, see <a href=\"https://docs.aws.amazon.com/personalize/latest/dg/measuring-recommendation-impact.html\">Measuring impact of recommendations</a>."
      },
      "EventType": {
        "type": "string",
        "maxLength": 256
      },
      "MetricName": {
        "type": "string",
        "maxLength": 256
      },
      "MetricExpression": {
        "type": "string",
        "maxLength": 256
      },
      "MetricAttributionOutput": {
        "type": "object",
        "required": [
          "roleArn"
        ],
        "properties": {
          "s3DataDestination": {
            "$ref": "#/$defs/S3DataConfig"
          },
          "roleArn": {
            "allOf": [
              {
                "$ref": "#/$defs/RoleArn"
              },
              {
                "description": "The Amazon Resource Name (ARN) of the IAM service role that has permissions to add data to your output Amazon S3 bucket and add metrics to Amazon CloudWatch. For more information, see <a href=\"https://docs.aws.amazon.com/personalize/latest/dg/measuring-recommendation-impact.html\">Measuring impact of recommendations</a>."
              }
            ]
          }
        },
        "description": "The output configuration details for a metric attribution."
      },
      "S3DataConfig": {
        "type": "object",
        "required": [
          "path"
        ],
        "properties": {
          "path": {
            "allOf": [
              {
                "$ref": "#/$defs/S3Location"
              },
              {
                "description": "The file path of the Amazon S3 bucket."
              }
            ]
          },
          "kmsKeyArn": {
            "allOf": [
              {
                "$ref": "#/$defs/KmsKeyArn"
              },
              {
                "description": "The Amazon Resource Name (ARN) of the Key Management Service (KMS) key that Amazon Personalize uses to encrypt or decrypt the input and output files."
              }
            ]
          }
        },
        "description": "The configuration details of an Amazon S3 input or output bucket."
      },
      "S3Location": {
        "type": "string",
        "pattern": "(s3|http|https)://.+",
        "maxLength": 256
      },
      "KmsKeyArn": {
        "type": "string",
        "pattern": "arn:aws.*:kms:.*:[0-9]{12}:key/.*",
        "maxLength": 2048
      },
      "RoleArn": {
        "type": "string",
        "pattern": "arn:([a-z\\d-]+):iam::\\d{12}:role/?[a-zA-Z_0-9+=,.@\\-_/]+",
        "maxLength": 256
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "http://personalize.us-east-1.amazonaws.com/#X-Amz-Target=AmazonPersonalize.CreateMetricAttribution"
    },
    "headers": {
      "X-Amz-Target": {
        "$": "X-Amz-Target"
      },
      "X-Amz-Content-Sha256": {
        "$": "X-Amz-Content-Sha256"
      },
      "X-Amz-Date": {
        "$": "X-Amz-Date"
      },
      "X-Amz-Algorithm": {
        "$": "X-Amz-Algorithm"
      },
      "X-Amz-Credential": {
        "$": "X-Amz-Credential"
      },
      "X-Amz-Security-Token": {
        "$": "X-Amz-Security-Token"
      },
      "X-Amz-Signature": {
        "$": "X-Amz-Signature"
      },
      "X-Amz-SignedHeaders": {
        "$": "X-Amz-SignedHeaders"
      }
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**metricAttributionArn**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "480": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "481": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "482": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "483": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "484": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    }
  }
}
