{
  "name": "VerifyPinData",
  "description": "<p>Verifies pin-related data such as PIN and PIN Offset using algorithms including VISA PVV and IBM3624. For more information, see <a href=\"https://docs.aws.amazon.com/payment-cryptography/latest/userguide/verify-pin-data.html\">Verify PIN data</a> in the <i>Amazon Web Services Payment Cryptography User Guide</i>.</p> <p>This operation verifies PIN data for user payment card. A card holder PIN data is never transmitted in clear to or from Amazon Web Services Payment Cryptography. This operation uses PIN Verification Key (PVK) for PIN or PIN Offset generation and then encrypts it using PIN Encryption Key (PEK) to create an <code>EncryptedPinBlock</code> for transmission from Amazon Web Services Payment Cryptography. </p> <p>For information about valid keys for this operation, see <a href=\"https://docs.aws.amazon.com/payment-cryptography/latest/userguide/keys-validattributes.html\">Understanding key attributes</a> and <a href=\"https://docs.aws.amazon.com/payment-cryptography/latest/userguide/crypto-ops-validkeys-ops.html\">Key types for specific data operations</a> in the <i>Amazon Web Services Payment Cryptography User Guide</i>. </p> <p> <b>Cross-account use</b>: This operation can't be used across different Amazon Web Services accounts.</p> <p> <b>Related operations:</b> </p> <ul> <li> <p> <a>GeneratePinData</a> </p> </li> <li> <p> <a>TranslatePinData</a> </p> </li> </ul>",
  "parameters": {
    "type": "object",
    "properties": {
      "X-Amz-Content-Sha256": {
        "type": "string"
      },
      "X-Amz-Date": {
        "type": "string"
      },
      "X-Amz-Algorithm": {
        "type": "string"
      },
      "X-Amz-Credential": {
        "type": "string"
      },
      "X-Amz-Security-Token": {
        "type": "string"
      },
      "X-Amz-Signature": {
        "type": "string"
      },
      "X-Amz-SignedHeaders": {
        "type": "string"
      },
      "body": {
        "type": "object",
        "required": [
          "EncryptedPinBlock",
          "EncryptionKeyIdentifier",
          "PinBlockFormat",
          "PrimaryAccountNumber",
          "VerificationAttributes",
          "VerificationKeyIdentifier"
        ],
        "properties": {
          "DukptAttributes": {
            "description": "Parameters that are used for Derived Unique Key Per Transaction (DUKPT) derivation algorithm.",
            "type": "object",
            "properties": {
              "DukptDerivationType": {
                "allOf": [
                  {
                    "$ref": "#/$defs/DukptDerivationType"
                  },
                  {
                    "description": "The key type derived using DUKPT from a Base Derivation Key (BDK) and Key Serial Number (KSN). This must be less than or equal to the strength of the BDK. For example, you can't use <code>AES_128</code> as a derivation type for a BDK of <code>AES_128</code> or <code>TDES_2KEY</code>."
                  }
                ]
              },
              "KeySerialNumber": {
                "allOf": [
                  {
                    "$ref": "#/$defs/HexLengthBetween10And24"
                  },
                  {
                    "description": "The unique identifier known as Key Serial Number (KSN) that comes from an encrypting device using DUKPT encryption method. The KSN is derived from the encrypting device unique identifier and an internal transaction counter."
                  }
                ]
              }
            }
          },
          "EncryptedPinBlock": {
            "description": "The encrypted PIN block data that Amazon Web Services Payment Cryptography verifies.",
            "type": "string",
            "pattern": "^[0-9a-fA-F]+$",
            "minLength": 16,
            "maxLength": 32
          },
          "EncryptionKeyIdentifier": {
            "description": "The <code>keyARN</code> of the encryption key under which the PIN block data is encrypted. This key type can be PEK or BDK.",
            "type": "string",
            "pattern": "^arn:aws:payment-cryptography:[a-z]{2}-[a-z]{1,16}-[0-9]+:[0-9]{12}:(key/[0-9a-zA-Z]{16,64}|alias/[a-zA-Z0-9/_-]+)$|^alias/[a-zA-Z0-9/_-]+$",
            "minLength": 7,
            "maxLength": 322
          },
          "PinBlockFormat": {
            "description": "<p>The PIN encoding format for pin data generation as specified in ISO 9564. Amazon Web Services Payment Cryptography supports <code>ISO_Format_0</code> and <code>ISO_Format_3</code>.</p> <p>The <code>ISO_Format_0</code> PIN block format is equivalent to the ANSI X9.8, VISA-1, and ECI-1 PIN block formats. It is similar to a VISA-4 PIN block format. It supports a PIN from 4 to 12 digits in length.</p> <p>The <code>ISO_Format_3</code> PIN block format is the same as <code>ISO_Format_0</code> except that the fill digits are random values from 10 to 15.</p>",
            "type": "string",
            "enum": [
              "ISO_FORMAT_0",
              "ISO_FORMAT_3"
            ]
          },
          "PinDataLength": {
            "description": "The length of PIN being verified.",
            "type": "integer",
            "minimum": 4,
            "maximum": 12
          },
          "PrimaryAccountNumber": {
            "description": "The Primary Account Number (PAN), a unique identifier for a payment credit or debit card that associates the card with a specific account holder.",
            "type": "string",
            "pattern": "^[0-9]+$",
            "minLength": 12,
            "maxLength": 19,
            "format": "password"
          },
          "VerificationAttributes": {
            "description": "Parameters that are required for PIN data verification.",
            "type": "object",
            "properties": {
              "Ibm3624Pin": {
                "allOf": [
                  {
                    "$ref": "#/$defs/Ibm3624PinVerification"
                  },
                  {
                    "description": "Parameters that are required to generate or verify Ibm3624 PIN."
                  }
                ]
              },
              "VisaPin": {
                "allOf": [
                  {
                    "$ref": "#/$defs/VisaPinVerification"
                  },
                  {
                    "description": "Parameters that are required to generate or verify Visa PIN."
                  }
                ]
              }
            }
          },
          "VerificationKeyIdentifier": {
            "description": "The <code>keyARN</code> of the PIN verification key.",
            "type": "string",
            "pattern": "^arn:aws:payment-cryptography:[a-z]{2}-[a-z]{1,16}-[0-9]+:[0-9]{12}:(key/[0-9a-zA-Z]{16,64}|alias/[a-zA-Z0-9/_-]+)$|^alias/[a-zA-Z0-9/_-]+$",
            "minLength": 7,
            "maxLength": 322
          }
        }
      }
    },
    "required": [
      "body"
    ],
    "$defs": {
      "DukptDerivationType": {
        "type": "string",
        "enum": [
          "TDES_2KEY",
          "TDES_3KEY",
          "AES_128",
          "AES_192",
          "AES_256"
        ]
      },
      "HexLengthBetween10And24": {
        "type": "string",
        "pattern": "^[0-9a-fA-F]+$",
        "minLength": 10,
        "maxLength": 24
      },
      "Ibm3624PinVerification": {
        "type": "object",
        "required": [
          "DecimalizationTable",
          "PinOffset",
          "PinValidationData",
          "PinValidationDataPadCharacter"
        ],
        "properties": {
          "DecimalizationTable": {
            "allOf": [
              {
                "$ref": "#/$defs/NumberLengthEquals16"
              },
              {
                "description": "The decimalization table to use for IBM 3624 PIN algorithm. The table is used to convert the algorithm intermediate result from hexadecimal characters to decimal."
              }
            ]
          },
          "PinOffset": {
            "allOf": [
              {
                "$ref": "#/$defs/NumberLengthBetween4And12"
              },
              {
                "description": "The PIN offset value."
              }
            ]
          },
          "PinValidationData": {
            "allOf": [
              {
                "$ref": "#/$defs/NumberLengthBetween4And16"
              },
              {
                "description": "The unique data for cardholder identification."
              }
            ]
          },
          "PinValidationDataPadCharacter": {
            "allOf": [
              {
                "$ref": "#/$defs/HexLengthEquals1"
              },
              {
                "description": "The padding character for validation data."
              }
            ]
          }
        },
        "description": "Parameters that are required to generate or verify Ibm3624 PIN verification PIN."
      },
      "NumberLengthEquals16": {
        "type": "string",
        "pattern": "^[0-9]+$",
        "minLength": 16,
        "maxLength": 16
      },
      "NumberLengthBetween4And12": {
        "type": "string",
        "pattern": "^[0-9]+$",
        "minLength": 4,
        "maxLength": 12
      },
      "NumberLengthBetween4And16": {
        "type": "string",
        "pattern": "^[0-9]+$",
        "minLength": 4,
        "maxLength": 16
      },
      "HexLengthEquals1": {
        "type": "string",
        "pattern": "^[0-9A-F]+$",
        "minLength": 1,
        "maxLength": 1
      },
      "VisaPinVerification": {
        "type": "object",
        "required": [
          "PinVerificationKeyIndex",
          "VerificationValue"
        ],
        "properties": {
          "PinVerificationKeyIndex": {
            "allOf": [
              {
                "$ref": "#/$defs/IntegerRangeBetween0And9"
              },
              {
                "description": "The value for PIN verification index. It is used in the Visa PIN algorithm to calculate the PVV (PIN Verification Value)."
              }
            ]
          },
          "VerificationValue": {
            "allOf": [
              {
                "$ref": "#/$defs/NumberLengthBetween4And12"
              },
              {
                "description": "Parameters that are required to generate or verify Visa PVV (PIN Verification Value)."
              }
            ]
          }
        },
        "description": "Parameters that are required to generate or verify Visa PIN."
      },
      "IntegerRangeBetween0And9": {
        "type": "integer",
        "minimum": 0,
        "maximum": 9
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "http://dataplane.payment-cryptography.us-east-1.amazonaws.com/pindata/verify"
    },
    "headers": {
      "X-Amz-Content-Sha256": {
        "$": "X-Amz-Content-Sha256"
      },
      "X-Amz-Date": {
        "$": "X-Amz-Date"
      },
      "X-Amz-Algorithm": {
        "$": "X-Amz-Algorithm"
      },
      "X-Amz-Credential": {
        "$": "X-Amz-Credential"
      },
      "X-Amz-Security-Token": {
        "$": "X-Amz-Security-Token"
      },
      "X-Amz-Signature": {
        "$": "X-Amz-Signature"
      },
      "X-Amz-SignedHeaders": {
        "$": "X-Amz-SignedHeaders"
      }
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**EncryptionKeyArn**",
            "**EncryptionKeyCheckValue**",
            "**VerificationKeyArn**",
            "**VerificationKeyCheckValue**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "480": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "481": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "482": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "483": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "484": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "485": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    }
  }
}
