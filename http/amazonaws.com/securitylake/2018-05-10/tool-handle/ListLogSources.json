{
  "name": "ListLogSources",
  "description": "Retrieves the log sources in the current Amazon Web Services Region.",
  "parameters": {
    "type": "object",
    "properties": {
      "maxResults": {
        "type": "string",
        "description": "Pagination limit"
      },
      "nextToken": {
        "type": "string",
        "description": "Pagination token"
      },
      "X-Amz-Content-Sha256": {
        "type": "string"
      },
      "X-Amz-Date": {
        "type": "string"
      },
      "X-Amz-Algorithm": {
        "type": "string"
      },
      "X-Amz-Credential": {
        "type": "string"
      },
      "X-Amz-Security-Token": {
        "type": "string"
      },
      "X-Amz-Signature": {
        "type": "string"
      },
      "X-Amz-SignedHeaders": {
        "type": "string"
      },
      "body": {
        "type": "object",
        "properties": {
          "accounts": {
            "description": "The list of Amazon Web Services accounts for which log sources are displayed.",
            "type": "array",
            "items": {
              "$ref": "#/$defs/AwsAccountId"
            }
          },
          "maxResults": {
            "description": "The maximum number of accounts for which the log sources are displayed.",
            "type": "integer",
            "minimum": 1,
            "maximum": 100
          },
          "nextToken": {
            "description": "If nextToken is returned, there are more results available. You can repeat the call using the returned token to retrieve the next page.",
            "type": "string",
            "pattern": "^[\\\\\\w\\-_:/.@=+]*$"
          },
          "regions": {
            "description": "The list of regions for which log sources are displayed.",
            "type": "array",
            "items": {
              "$ref": "#/$defs/Region"
            }
          },
          "sources": {
            "description": "The list of sources for which log sources are displayed.",
            "type": "array",
            "items": {
              "$ref": "#/$defs/LogSourceResource"
            }
          }
        }
      }
    },
    "required": [
      "body"
    ],
    "$defs": {
      "AwsAccountId": {
        "type": "string",
        "pattern": "^[0-9]{12}$",
        "minLength": 12,
        "maxLength": 12
      },
      "Region": {
        "type": "string",
        "pattern": "^(af|ap|ca|eu|me|sa|us)-(central|north|(north(?:east|west))|south|south(?:east|west)|east|west)-\\d+$"
      },
      "LogSourceResource": {
        "type": "object",
        "properties": {
          "awsLogSource": {
            "allOf": [
              {
                "$ref": "#/$defs/AwsLogSourceResource"
              },
              {
                "description": "Amazon Security Lake supports log and event collection for natively supported Amazon Web Services. For more information, see the <a href=\"https://docs.aws.amazon.com/security-lake/latest/userguide/internal-sources.html\">Amazon Security Lake User Guide</a>."
              }
            ]
          },
          "customLogSource": {
            "allOf": [
              {
                "$ref": "#/$defs/CustomLogSourceResource"
              },
              {
                "description": "Amazon Security Lake supports custom source types. For more information, see the <a href=\"https://docs.aws.amazon.com/security-lake/latest/userguide/custom-sources.html\">Amazon Security Lake User Guide</a>."
              }
            ]
          }
        },
        "description": "The supported source types from which logs and events are collected in Amazon Security Lake. For a list of supported Amazon Web Services, see the <a href=\"https://docs.aws.amazon.com/security-lake/latest/userguide/internal-sources.html\">Amazon Security Lake User Guide</a>."
      },
      "AwsLogSourceResource": {
        "type": "object",
        "properties": {
          "sourceName": {
            "allOf": [
              {
                "$ref": "#/$defs/AwsLogSourceName"
              },
              {
                "description": "The name for a Amazon Web Services source. This must be a Regionally unique value."
              }
            ]
          },
          "sourceVersion": {
            "allOf": [
              {
                "$ref": "#/$defs/AwsLogSourceVersion"
              },
              {
                "description": "The version for a Amazon Web Services source. This must be a Regionally unique value."
              }
            ]
          }
        },
        "description": "Amazon Security Lake can collect logs and events from natively-supported Amazon Web Services services."
      },
      "AwsLogSourceName": {
        "type": "string",
        "enum": [
          "ROUTE53",
          "VPC_FLOW",
          "SH_FINDINGS",
          "CLOUD_TRAIL_MGMT",
          "LAMBDA_EXECUTION",
          "S3_DATA"
        ]
      },
      "AwsLogSourceVersion": {
        "type": "string",
        "pattern": "^(latest|[0-9]\\.[0-9])$"
      },
      "CustomLogSourceResource": {
        "type": "object",
        "properties": {
          "attributes": {
            "allOf": [
              {
                "$ref": "#/$defs/CustomLogSourceAttributes"
              },
              {
                "description": "The attributes of a third-party custom source."
              }
            ]
          },
          "provider": {
            "allOf": [
              {
                "$ref": "#/$defs/CustomLogSourceProvider"
              },
              {
                "description": "The details of the log provider for a third-party custom source."
              }
            ]
          },
          "sourceName": {
            "allOf": [
              {
                "$ref": "#/$defs/CustomLogSourceName"
              },
              {
                "description": "The name for a third-party custom source. This must be a Regionally unique value."
              }
            ]
          },
          "sourceVersion": {
            "allOf": [
              {
                "$ref": "#/$defs/CustomLogSourceVersion"
              },
              {
                "description": "The version for a third-party custom source. This must be a Regionally unique value."
              }
            ]
          }
        },
        "description": "Amazon Security Lake can collect logs and events from third-party custom sources."
      },
      "CustomLogSourceAttributes": {
        "type": "object",
        "properties": {
          "crawlerArn": {
            "allOf": [
              {
                "$ref": "#/$defs/AmazonResourceName"
              },
              {
                "description": "The ARN of the Glue crawler."
              }
            ]
          },
          "databaseArn": {
            "allOf": [
              {
                "$ref": "#/$defs/AmazonResourceName"
              },
              {
                "description": "The ARN of the Glue database where results are written, such as: <code>arn:aws:daylight:us-east-1::database/sometable/*</code>."
              }
            ]
          },
          "tableArn": {
            "allOf": [
              {
                "$ref": "#/$defs/AmazonResourceName"
              },
              {
                "description": "The ARN of the Glue table."
              }
            ]
          }
        },
        "description": "The attributes of a third-party custom source."
      },
      "AmazonResourceName": {
        "type": "string",
        "pattern": "^arn:aws:securitylake:[A-za-z0-9_/.\\-]{0,63}:[A-za-z0-9_/.\\-]{0,63}:[A-Za-z0-9][A-za-z0-9_/.\\-]{0,127}$",
        "minLength": 1,
        "maxLength": 1011
      },
      "CustomLogSourceProvider": {
        "type": "object",
        "properties": {
          "location": {
            "allOf": [
              {
                "$ref": "#/$defs/S3URI"
              },
              {
                "description": "The location of the partition in the Amazon S3 bucket for Security Lake."
              }
            ]
          },
          "roleArn": {
            "allOf": [
              {
                "$ref": "#/$defs/RoleArn"
              },
              {
                "description": "The ARN of the IAM role to be used by the entity putting logs into your custom source partition. Security Lake will apply the correct access policies to this role, but you must first manually create the trust policy for this role. The IAM role name must start with the text 'Security Lake'. The IAM role must trust the <code>logProviderAccountId</code> to assume the role."
              }
            ]
          }
        },
        "description": "The details of the log provider for a third-party custom source."
      },
      "S3URI": {
        "type": "string",
        "pattern": "^s3[an]?://[a-z0-9][\\.\\-a-z0-9]{1,61}[a-z0-9](/[^/].*)+$",
        "description": "A complete S3 URI pointing to a valid S3 object.",
        "minLength": 0,
        "maxLength": 1024
      },
      "RoleArn": {
        "type": "string",
        "pattern": "^arn:.*$"
      },
      "CustomLogSourceName": {
        "type": "string",
        "pattern": "^[\\\\\\w\\-_:/.]*$",
        "minLength": 1,
        "maxLength": 64
      },
      "CustomLogSourceVersion": {
        "type": "string",
        "pattern": "^[A-Za-z0-9\\-\\.\\_]*$",
        "minLength": 1,
        "maxLength": 32
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "http://securitylake.us-east-1.amazonaws.com/v1/datalake/logsources/list{?maxResults,nextToken}"
    },
    "headers": {
      "X-Amz-Content-Sha256": {
        "$": "X-Amz-Content-Sha256"
      },
      "X-Amz-Date": {
        "$": "X-Amz-Date"
      },
      "X-Amz-Algorithm": {
        "$": "X-Amz-Algorithm"
      },
      "X-Amz-Credential": {
        "$": "X-Amz-Credential"
      },
      "X-Amz-Security-Token": {
        "$": "X-Amz-Security-Token"
      },
      "X-Amz-Signature": {
        "$": "X-Amz-Signature"
      },
      "X-Amz-SignedHeaders": {
        "$": "X-Amz-SignedHeaders"
      }
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**nextToken**",
            "**sources**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "480": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "481": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "482": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "483": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "484": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "485": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    }
  }
}
