{
  "name": "CreateAgent",
  "description": "<p>Activates an DataSync agent that you've deployed in your storage environment. The activation process associates the agent with your Amazon Web Services account.</p> <p>If you haven't deployed an agent yet, see the following topics to learn more:</p> <ul> <li> <p> <a href=\"https://docs.aws.amazon.com/datasync/latest/userguide/agent-requirements.html\">Agent requirements</a> </p> </li> <li> <p> <a href=\"https://docs.aws.amazon.com/datasync/latest/userguide/configure-agent.html\">Create an agent</a> </p> </li> </ul> <note> <p>If you're transferring between Amazon Web Services storage services, you don't need a DataSync agent. </p> </note>",
  "parameters": {
    "type": "object",
    "properties": {
      "X-Amz-Target": {
        "type": "string",
        "enum": [
          "FmrsService.CreateAgent"
        ]
      },
      "X-Amz-Content-Sha256": {
        "type": "string"
      },
      "X-Amz-Date": {
        "type": "string"
      },
      "X-Amz-Algorithm": {
        "type": "string"
      },
      "X-Amz-Credential": {
        "type": "string"
      },
      "X-Amz-Security-Token": {
        "type": "string"
      },
      "X-Amz-Signature": {
        "type": "string"
      },
      "X-Amz-SignedHeaders": {
        "type": "string"
      },
      "body": {
        "$ref": "#/$defs/CreateAgentRequest"
      }
    },
    "required": [
      "X-Amz-Target",
      "body"
    ],
    "$defs": {
      "CreateAgentRequest": {
        "type": "object",
        "required": [
          "ActivationKey"
        ],
        "title": "CreateAgentRequest",
        "properties": {
          "ActivationKey": {
            "allOf": [
              {
                "$ref": "#/$defs/ActivationKey"
              },
              {
                "description": "Specifies your DataSync agent's activation key. If you don't have an activation key, see <a href=\"https://docs.aws.amazon.com/datasync/latest/userguide/activate-agent.html\">Activate your agent</a>."
              }
            ]
          },
          "AgentName": {
            "allOf": [
              {
                "$ref": "#/$defs/TagValue"
              },
              {
                "description": "Specifies a name for your agent. You can see this name in the DataSync console."
              }
            ]
          },
          "Tags": {
            "allOf": [
              {
                "$ref": "#/$defs/InputTagList"
              },
              {
                "description": "Specifies labels that help you categorize, filter, and search for your Amazon Web Services resources. We recommend creating at least one tag for your agent."
              }
            ]
          },
          "VpcEndpointId": {
            "allOf": [
              {
                "$ref": "#/$defs/VpcEndpointId"
              },
              {
                "description": "<p>Specifies the ID of the VPC endpoint that you want your agent to connect to. For example, a VPC endpoint ID looks like <code>vpce-01234d5aff67890e1</code>.</p> <important> <p>The VPC endpoint you use must include the DataSync service name (for example, <code>com.amazonaws.us-east-2.datasync</code>).</p> </important>"
              }
            ]
          },
          "SubnetArns": {
            "allOf": [
              {
                "$ref": "#/$defs/PLSubnetArnList"
              },
              {
                "description": "Specifies the ARN of the subnet where you want to run your DataSync task when using a VPC endpoint. This is the subnet where DataSync creates and manages the <a href=\"https://docs.aws.amazon.com/datasync/latest/userguide/datasync-network.html#required-network-interfaces\">network interfaces</a> for your transfer. You can only specify one ARN."
              }
            ]
          },
          "SecurityGroupArns": {
            "allOf": [
              {
                "$ref": "#/$defs/PLSecurityGroupArnList"
              },
              {
                "description": "Specifies the Amazon Resource Name (ARN) of the security group that protects your task's <a href=\"https://docs.aws.amazon.com/datasync/latest/userguide/datasync-network.html#required-network-interfaces\">network interfaces</a> when <a href=\"https://docs.aws.amazon.com/datasync/latest/userguide/choose-service-endpoint.html#choose-service-endpoint-vpc\">using a virtual private cloud (VPC) endpoint</a>. You can only specify one ARN."
              }
            ]
          }
        },
        "description": "CreateAgentRequest"
      },
      "ActivationKey": {
        "type": "string",
        "pattern": "[A-Z0-9]{5}(-[A-Z0-9]{5}){4}",
        "maxLength": 29
      },
      "TagValue": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9\\s+=._:@/-]+$",
        "minLength": 1,
        "maxLength": 256
      },
      "InputTagList": {
        "type": "array",
        "items": {
          "$ref": "#/$defs/TagListEntry"
        },
        "minItems": 0,
        "maxItems": 50
      },
      "TagListEntry": {
        "type": "object",
        "required": [
          "Key"
        ],
        "properties": {
          "Key": {
            "allOf": [
              {
                "$ref": "#/$defs/TagKey"
              },
              {
                "description": "The key for an Amazon Web Services resource tag."
              }
            ]
          },
          "Value": {
            "allOf": [
              {
                "$ref": "#/$defs/TagValue"
              },
              {
                "description": "The value for an Amazon Web Services resource tag."
              }
            ]
          }
        },
        "description": "A key-value pair representing a single tag that's been applied to an Amazon Web Services resource."
      },
      "TagKey": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9\\s+=._:/-]+$",
        "minLength": 1,
        "maxLength": 256
      },
      "VpcEndpointId": {
        "type": "string",
        "pattern": "^vpce-[0-9a-f]{17}$"
      },
      "PLSubnetArnList": {
        "type": "array",
        "items": {
          "$ref": "#/$defs/Ec2SubnetArn"
        },
        "minItems": 1,
        "maxItems": 1
      },
      "Ec2SubnetArn": {
        "type": "string",
        "pattern": "^arn:(aws|aws-cn|aws-us-gov|aws-iso|aws-iso-b):ec2:[a-z\\-0-9]*:[0-9]{12}:subnet/.*$",
        "maxLength": 128
      },
      "PLSecurityGroupArnList": {
        "type": "array",
        "items": {
          "$ref": "#/$defs/Ec2SecurityGroupArn"
        },
        "minItems": 1,
        "maxItems": 1
      },
      "Ec2SecurityGroupArn": {
        "type": "string",
        "pattern": "^arn:(aws|aws-cn|aws-us-gov|aws-iso|aws-iso-b):ec2:[a-z\\-0-9]*:[0-9]{12}:security-group/sg-[a-f0-9]+$",
        "maxLength": 128
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "http://datasync.us-east-1.amazonaws.com/#X-Amz-Target=FmrsService.CreateAgent"
    },
    "headers": {
      "X-Amz-Target": {
        "$": "X-Amz-Target"
      },
      "X-Amz-Content-Sha256": {
        "$": "X-Amz-Content-Sha256"
      },
      "X-Amz-Date": {
        "$": "X-Amz-Date"
      },
      "X-Amz-Algorithm": {
        "$": "X-Amz-Algorithm"
      },
      "X-Amz-Credential": {
        "$": "X-Amz-Credential"
      },
      "X-Amz-Security-Token": {
        "$": "X-Amz-Security-Token"
      },
      "X-Amz-Signature": {
        "$": "X-Amz-Signature"
      },
      "X-Amz-SignedHeaders": {
        "$": "X-Amz-SignedHeaders"
      }
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "CreateAgentResponse",
        "**Key properties:**",
        {
          "$ul": [
            "**AgentArn**"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "480": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "481": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    }
  }
}
