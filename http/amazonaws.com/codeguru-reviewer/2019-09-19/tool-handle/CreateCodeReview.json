{
  "name": "CreateCodeReview",
  "description": "Use to create a code review with a <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_CodeReviewType.html\">CodeReviewType</a> of <code>RepositoryAnalysis</code>. This type of code review analyzes all code under a specified branch in an associated repository. <code>PullRequest</code> code reviews are automatically triggered by a pull request.",
  "parameters": {
    "type": "object",
    "properties": {
      "X-Amz-Content-Sha256": {
        "type": "string"
      },
      "X-Amz-Date": {
        "type": "string"
      },
      "X-Amz-Algorithm": {
        "type": "string"
      },
      "X-Amz-Credential": {
        "type": "string"
      },
      "X-Amz-Security-Token": {
        "type": "string"
      },
      "X-Amz-Signature": {
        "type": "string"
      },
      "X-Amz-SignedHeaders": {
        "type": "string"
      },
      "body": {
        "type": "object",
        "required": [
          "Name",
          "RepositoryAssociationArn",
          "Type"
        ],
        "properties": {
          "Name": {
            "description": "The name of the code review. The name of each code review in your Amazon Web Services account must be unique.",
            "type": "string",
            "pattern": "[a-zA-Z0-9-_]*",
            "minLength": 1,
            "maxLength": 100
          },
          "RepositoryAssociationArn": {
            "description": "<p>The Amazon Resource Name (ARN) of the <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_RepositoryAssociation.html\">RepositoryAssociation</a> object. You can retrieve this ARN by calling <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_ListRepositoryAssociations.html\">ListRepositoryAssociations</a>.</p> <p>A code review can only be created on an associated repository. This is the ARN of the associated repository.</p>",
            "type": "string",
            "pattern": "^arn:aws[^:\\s]*:codeguru-reviewer:[^:\\s]+:[\\d]{12}:association:[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$",
            "minLength": 1,
            "maxLength": 1600
          },
          "Type": {
            "description": "<p>The type of a code review. There are two code review types:</p> <ul> <li> <p> <code>PullRequest</code> - A code review that is automatically triggered by a pull request on an associated repository.</p> </li> <li> <p> <code>RepositoryAnalysis</code> - A code review that analyzes all code under a specified branch in an associated repository. The associated repository is specified using its ARN in <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_CreateCodeReview\">CreateCodeReview</a>.</p> </li> </ul>",
            "type": "object",
            "properties": {
              "RepositoryAnalysis": {
                "allOf": [
                  {
                    "$ref": "#/$defs/RepositoryAnalysis"
                  },
                  {
                    "description": "A code review that analyzes all code under a specified branch in an associated repository. The associated repository is specified using its ARN in <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_CreateCodeReview\">CreateCodeReview</a>."
                  }
                ]
              },
              "AnalysisTypes": {
                "allOf": [
                  {
                    "$ref": "#/$defs/AnalysisTypes"
                  },
                  {
                    "description": "They types of analysis performed during a repository analysis or a pull request review. You can specify either <code>Security</code>, <code>CodeQuality</code>, or both."
                  }
                ]
              }
            }
          },
          "ClientRequestToken": {
            "description": "Amazon CodeGuru Reviewer uses this value to prevent the accidental creation of duplicate code reviews if there are failures and retries.",
            "type": "string",
            "pattern": "^[\\w-]+$",
            "minLength": 1,
            "maxLength": 64
          }
        }
      }
    },
    "required": [
      "body"
    ],
    "$defs": {
      "RepositoryAnalysis": {
        "type": "object",
        "properties": {
          "RepositoryHead": {
            "allOf": [
              {
                "$ref": "#/$defs/RepositoryHeadSourceCodeType"
              },
              {
                "description": "A <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_SourceCodeType\">SourceCodeType</a> that specifies the tip of a branch in an associated repository."
              }
            ]
          },
          "SourceCodeType": {
            "$ref": "#/$defs/SourceCodeType"
          }
        },
        "description": "A code review type that analyzes all code under a specified branch in an associated repository. The associated repository is specified using its ARN when you call <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_CreateCodeReview\">CreateCodeReview</a>."
      },
      "RepositoryHeadSourceCodeType": {
        "type": "object",
        "required": [
          "BranchName"
        ],
        "properties": {
          "BranchName": {
            "allOf": [
              {
                "$ref": "#/$defs/BranchName"
              },
              {
                "description": "The name of the branch in an associated repository. The <code>RepositoryHeadSourceCodeType</code> specifies the tip of this branch."
              }
            ]
          }
        },
        "description": "A <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_SourceCodeType\">SourceCodeType</a> that specifies the tip of a branch in an associated repository."
      },
      "BranchName": {
        "type": "string",
        "minLength": 1,
        "maxLength": 256
      },
      "SourceCodeType": {
        "type": "object",
        "properties": {
          "CommitDiff": {
            "allOf": [
              {
                "$ref": "#/$defs/CommitDiffSourceCodeType"
              },
              {
                "description": "A <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_SourceCodeType\">SourceCodeType</a> that specifies a commit diff created by a pull request on an associated repository."
              }
            ]
          },
          "RepositoryHead": {
            "$ref": "#/$defs/RepositoryHeadSourceCodeType"
          },
          "BranchDiff": {
            "allOf": [
              {
                "$ref": "#/$defs/BranchDiffSourceCodeType"
              },
              {
                "description": "A type of <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_SourceCodeType\">SourceCodeType</a> that specifies a source branch name and a destination branch name in an associated repository."
              }
            ]
          },
          "S3BucketRepository": {
            "allOf": [
              {
                "$ref": "#/$defs/S3BucketRepository"
              },
              {
                "description": "Information about an associated repository in an S3 bucket that includes its name and an <code>S3RepositoryDetails</code> object. The <code>S3RepositoryDetails</code> object includes the name of an S3 bucket, an S3 key for a source code .zip file, and an S3 key for a build artifacts .zip file. <code>S3BucketRepository</code> is required in <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_SourceCodeType\">SourceCodeType</a> for <code>S3BucketRepository</code> based code reviews."
              }
            ]
          },
          "RequestMetadata": {
            "allOf": [
              {
                "$ref": "#/$defs/RequestMetadata"
              },
              {
                "description": "Metadata that is associated with a code review. This applies to any type of code review supported by CodeGuru Reviewer. The <code>RequestMetadaa</code> field captures any event metadata. For example, it might capture metadata associated with an event trigger, such as a push or a pull request."
              }
            ]
          }
        },
        "description": "Specifies the source code that is analyzed in a code review."
      },
      "CommitDiffSourceCodeType": {
        "type": "object",
        "properties": {
          "SourceCommit": {
            "allOf": [
              {
                "$ref": "#/$defs/CommitId"
              },
              {
                "description": "The SHA of the source commit used to generate a commit diff. This field is required for a pull request code review."
              }
            ]
          },
          "DestinationCommit": {
            "allOf": [
              {
                "$ref": "#/$defs/CommitId"
              },
              {
                "description": "The SHA of the destination commit used to generate a commit diff. This field is required for a pull request code review."
              }
            ]
          },
          "MergeBaseCommit": {
            "allOf": [
              {
                "$ref": "#/$defs/CommitId"
              },
              {
                "description": "The SHA of the merge base of a commit."
              }
            ]
          }
        },
        "description": "A type of <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_SourceCodeType\">SourceCodeType</a> that specifies the commit diff for a pull request on an associated repository. The <code>SourceCommit</code> and <code>DestinationCommit</code> fields are required to do a pull request code review."
      },
      "CommitId": {
        "type": "string",
        "minLength": 6,
        "maxLength": 64
      },
      "BranchDiffSourceCodeType": {
        "type": "object",
        "required": [
          "SourceBranchName",
          "DestinationBranchName"
        ],
        "properties": {
          "SourceBranchName": {
            "allOf": [
              {
                "$ref": "#/$defs/BranchName"
              },
              {
                "description": "The source branch for a diff in an associated repository."
              }
            ]
          },
          "DestinationBranchName": {
            "allOf": [
              {
                "$ref": "#/$defs/BranchName"
              },
              {
                "description": "The destination branch for a diff in an associated repository."
              }
            ]
          }
        },
        "description": "A type of <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_SourceCodeType\">SourceCodeType</a> that specifies a code diff between a source and destination branch in an associated repository."
      },
      "S3BucketRepository": {
        "type": "object",
        "required": [
          "Name"
        ],
        "properties": {
          "Name": {
            "allOf": [
              {
                "$ref": "#/$defs/Name"
              },
              {
                "description": "The name of the repository when the <code>ProviderType</code> is <code>S3Bucket</code>."
              }
            ]
          },
          "Details": {
            "allOf": [
              {
                "$ref": "#/$defs/S3RepositoryDetails"
              },
              {
                "description": "An <code>S3RepositoryDetails</code> object that specifies the name of an S3 bucket and a <code>CodeArtifacts</code> object. The <code>CodeArtifacts</code> object includes the S3 object keys for a source code .zip file and for a build artifacts .zip file."
              }
            ]
          }
        },
        "description": "Information about an associated repository in an S3 bucket. The associated repository contains a source code .zip file and a build artifacts .zip file that contains .jar or .class files."
      },
      "Name": {
        "type": "string",
        "pattern": "^\\S[\\w.-]*$",
        "minLength": 1,
        "maxLength": 100
      },
      "S3RepositoryDetails": {
        "type": "object",
        "properties": {
          "BucketName": {
            "allOf": [
              {
                "$ref": "#/$defs/S3BucketName"
              },
              {
                "description": "The name of the S3 bucket used for associating a new S3 repository. It must begin with <code>codeguru-reviewer-</code>. "
              }
            ]
          },
          "CodeArtifacts": {
            "allOf": [
              {
                "$ref": "#/$defs/CodeArtifacts"
              },
              {
                "description": "A <code>CodeArtifacts</code> object. The <code>CodeArtifacts</code> object includes the S3 object key for a source code .zip file and for a build artifacts .zip file that contains .jar or .class files."
              }
            ]
          }
        },
        "description": "Specifies the name of an S3 bucket and a <code>CodeArtifacts</code> object that contains the S3 object keys for a source code .zip file and for a build artifacts .zip file that contains .jar or .class files."
      },
      "S3BucketName": {
        "type": "string",
        "pattern": "^\\S(.*\\S)?$",
        "minLength": 3,
        "maxLength": 63
      },
      "CodeArtifacts": {
        "type": "object",
        "required": [
          "SourceCodeArtifactsObjectKey"
        ],
        "properties": {
          "SourceCodeArtifactsObjectKey": {
            "allOf": [
              {
                "$ref": "#/$defs/SourceCodeArtifactsObjectKey"
              },
              {
                "description": "The S3 object key for a source code .zip file. This is required for all code reviews."
              }
            ]
          },
          "BuildArtifactsObjectKey": {
            "allOf": [
              {
                "$ref": "#/$defs/BuildArtifactsObjectKey"
              },
              {
                "description": "The S3 object key for a build artifacts .zip file that contains .jar or .class files. This is required for a code review with security analysis. For more information, see <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-ug/working-with-cicd.html\">Create code reviews with GitHub Actions</a> in the <i>Amazon CodeGuru Reviewer User Guide</i>."
              }
            ]
          }
        },
        "description": "<p>Code artifacts are source code artifacts and build artifacts used in a repository analysis or a pull request review.</p> <ul> <li> <p>Source code artifacts are source code files in a Git repository that are compressed into a .zip file.</p> </li> <li> <p>Build artifacts are .jar or .class files that are compressed in a .zip file.</p> </li> </ul>"
      },
      "SourceCodeArtifactsObjectKey": {
        "type": "string",
        "pattern": "^\\S(.*\\S)?$",
        "minLength": 1,
        "maxLength": 1024
      },
      "BuildArtifactsObjectKey": {
        "type": "string",
        "pattern": "^\\S(.*\\S)?$",
        "minLength": 1,
        "maxLength": 1024
      },
      "RequestMetadata": {
        "type": "object",
        "properties": {
          "RequestId": {
            "allOf": [
              {
                "$ref": "#/$defs/RequestId"
              },
              {
                "description": "The ID of the request. This is required for a pull request code review."
              }
            ]
          },
          "Requester": {
            "allOf": [
              {
                "$ref": "#/$defs/Requester"
              },
              {
                "description": "An identifier, such as a name or account ID, that is associated with the requester. The <code>Requester</code> is used to capture the <code>author/actor</code> name of the event request."
              }
            ]
          },
          "EventInfo": {
            "allOf": [
              {
                "$ref": "#/$defs/EventInfo"
              },
              {
                "description": "Information about the event associated with a code review."
              }
            ]
          },
          "VendorName": {
            "allOf": [
              {
                "$ref": "#/$defs/VendorName"
              },
              {
                "description": "The name of the repository vendor used to upload code to an S3 bucket for a CI/CD code review. For example, if code and artifacts are uploaded to an S3 bucket for a CI/CD code review by GitHub scripts from a GitHub repository, then the repository association's <code>ProviderType</code> is <code>S3Bucket</code> and the CI/CD repository vendor name is GitHub. For more information, see the definition for <code>ProviderType</code> in <a href=\"https://docs.aws.amazon.com/codeguru/latest/reviewer-api/API_RepositoryAssociation.html\">RepositoryAssociation</a>."
              }
            ]
          }
        },
        "description": "Metadata that is associated with a code review. This applies to both pull request and repository analysis code reviews."
      },
      "RequestId": {
        "type": "string",
        "minLength": 1,
        "maxLength": 64
      },
      "Requester": {
        "type": "string",
        "pattern": "^\\S(.*\\S)?$",
        "minLength": 1,
        "maxLength": 100
      },
      "EventInfo": {
        "type": "object",
        "properties": {
          "Name": {
            "allOf": [
              {
                "$ref": "#/$defs/EventName"
              },
              {
                "description": "The name of the event. The possible names are <code>pull_request</code>, <code>workflow_dispatch</code>, <code>schedule</code>, and <code>push</code> "
              }
            ]
          },
          "State": {
            "allOf": [
              {
                "$ref": "#/$defs/EventState"
              },
              {
                "description": "The state of an event. The state might be open, closed, or another state."
              }
            ]
          }
        },
        "description": "Information about an event. The event might be a push, pull request, scheduled request, or another type of event."
      },
      "EventName": {
        "type": "string",
        "pattern": "^[ \\-A-Z_a-z]+$",
        "minLength": 1,
        "maxLength": 32
      },
      "EventState": {
        "type": "string",
        "pattern": "^[ \\-A-Z_a-z]+$",
        "minLength": 1,
        "maxLength": 32
      },
      "VendorName": {
        "type": "string",
        "enum": [
          "GitHub",
          "GitLab",
          "NativeS3"
        ]
      },
      "AnalysisTypes": {
        "type": "array",
        "items": {
          "$ref": "#/$defs/AnalysisType"
        }
      },
      "AnalysisType": {
        "type": "string",
        "enum": [
          "Security",
          "CodeQuality"
        ]
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "http://codeguru-reviewer.us-east-1.amazonaws.com/codereviews"
    },
    "headers": {
      "X-Amz-Content-Sha256": {
        "$": "X-Amz-Content-Sha256"
      },
      "X-Amz-Date": {
        "$": "X-Amz-Date"
      },
      "X-Amz-Algorithm": {
        "$": "X-Amz-Algorithm"
      },
      "X-Amz-Credential": {
        "$": "X-Amz-Credential"
      },
      "X-Amz-Security-Token": {
        "$": "X-Amz-Security-Token"
      },
      "X-Amz-Signature": {
        "$": "X-Amz-Signature"
      },
      "X-Amz-SignedHeaders": {
        "$": "X-Amz-SignedHeaders"
      }
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            [
              "**CodeReview**: Information about a code review. A code review belongs to the associated repository that contains the reviewed code.",
              {
                "$ul": [
                  "**Name**",
                  "**CodeReviewArn**",
                  "**RepositoryName**",
                  "**Owner**",
                  "**ProviderType**",
                  "**State**",
                  "**StateReason**",
                  "**CreatedTimeStamp**",
                  "**LastUpdatedTimeStamp**",
                  "**Type**",
                  "**PullRequestId**",
                  "**SourceCodeType**",
                  "**AssociationArn**",
                  "**Metrics**",
                  "**AnalysisTypes**",
                  "**ConfigFileState**"
                ]
              }
            ]
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "480": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "481": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "482": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "483": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "484": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    },
    "485": {
      "$encode": "markdown",
      "$lang": "json",
      "$code": {
        "$encode": "json",
        "$indent": true,
        "$content": {
          "$": "$.body"
        }
      }
    }
  }
}
