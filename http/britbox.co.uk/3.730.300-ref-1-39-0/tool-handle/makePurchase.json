{
  "name": "makePurchase",
  "description": "Purchase a plan or item offer.\nThe result of a successful transaction is a new entitlement.\n",
  "parameters": {
    "type": "object",
    "properties": {
      "ff": {
        "items": {
          "enum": [
            "all",
            "idp",
            "ldp",
            "hb",
            "rpt",
            "cas",
            "lrl",
            "cd"
          ],
          "type": "string"
        },
        "type": "array",
        "description": "The set of opt in feature flags which cause breaking changes to responses.\n\nWhile Rocket APIs look to avoid breaking changes under the active major version, the formats of responses\nmay need to evolve over this time.\n\nThese feature flags allow clients to select which response formats they expect and avoid breaking\nclients as these formats evolve under the current major version.\n\n### Flags\n\n- `all` - Enable all flags. Useful for testing. _Don't use in production_.\n- `idp` - Dynamic item detail pages with schedulable rows.\n- `ldp` - Dynamic list detail pages with schedulable rows.\n- `hb` - Hubble formatted image urls.\n- `rpt` - Updated resume point threshold logic.\n- `cas` - \"Custom Asset Search\", inlcude `customAssets` in search results.\n- `lrl` - Do not pre-populate related list if more than `max_list_prefetch` down the page.\n- `cd` - Custom Destination support.\n\nSee the `feature-flags.md` for available flag details.\n"
      },
      "lang": {
        "type": "string",
        "description": "Language code for the preferred language to be returned in the response.\n\nParameter value is case-insensitive and should be\n  - a valid 2 letter language code without region such as en, de\n  - or with region such as en_us, en_au\n\nIf undefined then defaults to 'en', unless the server has been configured\nwith a custom default.\n\nSee https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes\n"
      },
      "body": {
        "$ref": "#/components/schemas/PurchaseRequest",
        "description": "Details of a plan or item purchase."
      }
    },
    "required": [
      "body"
    ]
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "/api/account/billing/purchases{?ff,lang}"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "The base type for both Offer and Entitlement.",
        "**Key properties:**",
        {
          "$ul": [
            "**deliveryType**",
            "**exclusionRules**: Any specific playback exclusion rules.",
            "**maxDownloads**: The maximum number of allowed downloads.",
            "**maxPlays**: The maximum number of allowed plays.",
            "**ownership**",
            "**playPeriod**: The length of time in minutes which the rental will last once played for the first time.",
            "**rentalPeriod**: The length of time in minutes which the rental will last once purchased.",
            "**resolution**",
            "**scopes**",
            "**activationDate**: The date of activation. If no date is defined the entitlement has not be activated.",
            [
              "**classification**",
              {
                "$ul": [
                  "**code**: The unique code for a classification.",
                  "**name**: The name of the classification for display."
                ]
              }
            ],
            "**creationDate**: The date the entitlement was created.",
            "**expirationDate**: The date the entitlement expires.",
            "**itemId**: The id of the item this entitlement is for.",
            "**itemType**: The type of item this entitlement is for.",
            "**mediaDuration**: The duration of the entitled media.",
            "**planId**: The id of the plan this entitlement is for.",
            "**playCount**: How many times the media has been played.",
            "**remainingDownloads**: How many more downloads of this media are available."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "400": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**code**: An optional code classifying the error. Should be taken in the context of the http status code.",
            "**message**: A description of the error."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "401": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**code**: An optional code classifying the error. Should be taken in the context of the http status code.",
            "**message**: A description of the error."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "403": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**code**: An optional code classifying the error. Should be taken in the context of the http status code.",
            "**message**: A description of the error."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "404": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**code**: An optional code classifying the error. Should be taken in the context of the http status code.",
            "**message**: A description of the error."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "415": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**code**: An optional code classifying the error. Should be taken in the context of the http status code.",
            "**message**: A description of the error."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "500": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**code**: An optional code classifying the error. Should be taken in the context of the http status code.",
            "**message**: A description of the error."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "default": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**code**: An optional code classifying the error. Should be taken in the context of the http status code.",
            "**message**: A description of the error."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
