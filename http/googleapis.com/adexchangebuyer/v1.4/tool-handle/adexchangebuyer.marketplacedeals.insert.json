{
  "name": "adexchangebuyer_marketplacedeals_insert",
  "description": "Add new deals for the specified proposal",
  "parameters": {
    "type": "object",
    "properties": {
      "proposalId": {
        "type": "string",
        "description": "proposalId for which deals need to be added."
      },
      "alt": {
        "enum": [
          "json"
        ],
        "type": "string",
        "description": "Data format for the response."
      },
      "fields": {
        "type": "string",
        "description": "Selector specifying which fields to include in a partial response."
      },
      "key": {
        "type": "string",
        "description": "API key. Your API key identifies your project and provides you with API access, quota, and reports. Required unless you provide an OAuth 2.0 token."
      },
      "oauth_token": {
        "type": "string",
        "description": "OAuth 2.0 token for the current user."
      },
      "prettyPrint": {
        "type": "boolean",
        "description": "Returns response with indentations and line breaks."
      },
      "quotaUser": {
        "type": "string",
        "description": "An opaque string that represents a user for quota purposes. Must not exceed 40 characters."
      },
      "userIp": {
        "type": "string",
        "description": "Deprecated. Please use quotaUser instead."
      },
      "body": {
        "$ref": "#/$defs/AddOrderDealsRequest"
      }
    },
    "required": [
      "proposalId"
    ],
    "$defs": {
      "AddOrderDealsRequest": {
        "properties": {
          "deals": {
            "description": "The list of deals to add",
            "items": {
              "$ref": "#/$defs/MarketplaceDeal"
            },
            "type": "array"
          },
          "proposalRevisionNumber": {
            "description": "The last known proposal revision number.",
            "format": "int64",
            "type": "string"
          },
          "updateAction": {
            "description": "Indicates an optional action to take on the proposal",
            "type": "string"
          }
        },
        "type": "object"
      },
      "MarketplaceDeal": {
        "description": "A proposal can contain multiple deals. A deal contains the terms and targeting information that is used for serving.",
        "properties": {
          "buyerPrivateData": {
            "$ref": "#/$defs/PrivateData"
          },
          "creationTimeMs": {
            "description": "The time (ms since epoch) of the deal creation. (readonly)",
            "format": "int64",
            "type": "string"
          },
          "creativePreApprovalPolicy": {
            "description": "Specifies the creative pre-approval policy (buyer-readonly)",
            "type": "string"
          },
          "creativeSafeFrameCompatibility": {
            "description": "Specifies whether the creative is safeFrame compatible (buyer-readonly)",
            "type": "string"
          },
          "dealId": {
            "description": "A unique deal-id for the deal (readonly).",
            "type": "string"
          },
          "dealServingMetadata": {
            "$ref": "#/$defs/DealServingMetadata"
          },
          "deliveryControl": {
            "$ref": "#/$defs/DeliveryControl"
          },
          "externalDealId": {
            "description": "The external deal id assigned to this deal once the deal is finalized. This is the deal-id that shows up in serving/reporting etc. (readonly)",
            "type": "string"
          },
          "flightEndTimeMs": {
            "description": "Proposed flight end time of the deal (ms since epoch) This will generally be stored in a granularity of a second. (updatable)",
            "format": "int64",
            "type": "string"
          },
          "flightStartTimeMs": {
            "description": "Proposed flight start time of the deal (ms since epoch) This will generally be stored in a granularity of a second. (updatable)",
            "format": "int64",
            "type": "string"
          },
          "inventoryDescription": {
            "description": "Description for the deal terms. (buyer-readonly)",
            "type": "string"
          },
          "isRfpTemplate": {
            "description": "Indicates whether the current deal is a RFP template. RFP template is created by buyer and not based on seller created products.",
            "type": "boolean"
          },
          "isSetupComplete": {
            "description": "True, if the buyside inventory setup is complete for this deal. (readonly, except via OrderSetupCompleted action)",
            "type": "boolean"
          },
          "kind": {
            "default": "adexchangebuyer#marketplaceDeal",
            "description": "Identifies what kind of resource this is. Value: the fixed string \"adexchangebuyer#marketplaceDeal\".",
            "type": "string"
          },
          "lastUpdateTimeMs": {
            "description": "The time (ms since epoch) when the deal was last updated. (readonly)",
            "format": "int64",
            "type": "string"
          },
          "makegoodRequestedReason": {
            "type": "string"
          },
          "name": {
            "description": "The name of the deal. (updatable)",
            "type": "string"
          },
          "productId": {
            "description": "The product-id from which this deal was created. (readonly, except on create)",
            "type": "string"
          },
          "productRevisionNumber": {
            "description": "The revision number of the product that the deal was created from (readonly, except on create)",
            "format": "int64",
            "type": "string"
          },
          "programmaticCreativeSource": {
            "description": "Specifies the creative source for programmatic deals, PUBLISHER means creative is provided by seller and ADVERTISR means creative is provided by buyer. (buyer-readonly)",
            "type": "string"
          },
          "proposalId": {
            "type": "string"
          },
          "sellerContacts": {
            "description": "Optional Seller contact information for the deal (buyer-readonly)",
            "items": {
              "$ref": "#/$defs/ContactInformation"
            },
            "type": "array"
          },
          "sharedTargetings": {
            "description": "The shared targeting visible to buyers and sellers. Each shared targeting entity is AND'd together. (updatable)",
            "items": {
              "$ref": "#/$defs/SharedTargeting"
            },
            "type": "array"
          },
          "syndicationProduct": {
            "description": "The syndication product associated with the deal. (readonly, except on create)",
            "type": "string"
          },
          "terms": {
            "$ref": "#/$defs/DealTerms"
          },
          "webPropertyCode": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "PrivateData": {
        "properties": {
          "referenceId": {
            "type": "string"
          },
          "referencePayload": {
            "format": "byte",
            "type": "string"
          }
        },
        "type": "object"
      },
      "DealServingMetadata": {
        "properties": {
          "alcoholAdsAllowed": {
            "description": "True if alcohol ads are allowed for this deal (read-only). This field is only populated when querying for finalized orders using the method GetFinalizedOrderDeals",
            "type": "boolean"
          },
          "dealPauseStatus": {
            "$ref": "#/$defs/DealServingMetadataDealPauseStatus"
          }
        },
        "type": "object"
      },
      "DealServingMetadataDealPauseStatus": {
        "description": "Tracks which parties (if any) have paused a deal. The deal is considered paused if has_buyer_paused || has_seller_paused. Each of the has_buyer_paused or the has_seller_paused bits can be set independently.",
        "properties": {
          "buyerPauseReason": {
            "type": "string"
          },
          "firstPausedBy": {
            "description": "If the deal is paused, records which party paused the deal first.",
            "type": "string"
          },
          "hasBuyerPaused": {
            "type": "boolean"
          },
          "hasSellerPaused": {
            "type": "boolean"
          },
          "sellerPauseReason": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "DeliveryControl": {
        "properties": {
          "creativeBlockingLevel": {
            "type": "string"
          },
          "deliveryRateType": {
            "type": "string"
          },
          "frequencyCaps": {
            "items": {
              "$ref": "#/$defs/DeliveryControlFrequencyCap"
            },
            "type": "array"
          }
        },
        "type": "object"
      },
      "DeliveryControlFrequencyCap": {
        "properties": {
          "maxImpressions": {
            "format": "int32",
            "type": "integer"
          },
          "numTimeUnits": {
            "format": "int32",
            "type": "integer"
          },
          "timeUnitType": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "ContactInformation": {
        "properties": {
          "email": {
            "description": "Email address of the contact.",
            "type": "string"
          },
          "name": {
            "description": "The name of the contact.",
            "type": "string"
          }
        },
        "type": "object"
      },
      "SharedTargeting": {
        "properties": {
          "exclusions": {
            "description": "The list of values to exclude from targeting. Each value is AND'd together.",
            "items": {
              "$ref": "#/$defs/TargetingValue"
            },
            "type": "array"
          },
          "inclusions": {
            "description": "The list of value to include as part of the targeting. Each value is OR'd together.",
            "items": {
              "$ref": "#/$defs/TargetingValue"
            },
            "type": "array"
          },
          "key": {
            "description": "The key representing the shared targeting criterion.",
            "type": "string"
          }
        },
        "type": "object"
      },
      "TargetingValue": {
        "properties": {
          "creativeSizeValue": {
            "$ref": "#/$defs/TargetingValueCreativeSize"
          },
          "dayPartTargetingValue": {
            "$ref": "#/$defs/TargetingValueDayPartTargeting"
          },
          "demogAgeCriteriaValue": {
            "$ref": "#/$defs/TargetingValueDemogAgeCriteria"
          },
          "demogGenderCriteriaValue": {
            "$ref": "#/$defs/TargetingValueDemogGenderCriteria"
          },
          "longValue": {
            "description": "The long value to exclude/include.",
            "format": "int64",
            "type": "string"
          },
          "requestPlatformTargetingValue": {
            "$ref": "#/$defs/TargetingValueRequestPlatformTargeting"
          },
          "stringValue": {
            "description": "The string value to exclude/include.",
            "type": "string"
          }
        },
        "type": "object"
      },
      "TargetingValueCreativeSize": {
        "description": "Next Id: 7",
        "properties": {
          "allowedFormats": {
            "description": "The formats allowed by the publisher.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "companionSizes": {
            "description": "For video size type, the list of companion sizes.",
            "items": {
              "$ref": "#/$defs/TargetingValueSize"
            },
            "type": "array"
          },
          "creativeSizeType": {
            "description": "The Creative size type.",
            "type": "string"
          },
          "nativeTemplate": {
            "description": "The native template for native ad.",
            "type": "string"
          },
          "size": {
            "$ref": "#/$defs/TargetingValueSize"
          },
          "skippableAdType": {
            "description": "The skippable ad type for video size.",
            "type": "string"
          }
        },
        "type": "object"
      },
      "TargetingValueSize": {
        "properties": {
          "height": {
            "description": "The height of the creative.",
            "format": "int32",
            "type": "integer"
          },
          "width": {
            "description": "The width of the creative.",
            "format": "int32",
            "type": "integer"
          }
        },
        "type": "object"
      },
      "TargetingValueDayPartTargeting": {
        "properties": {
          "dayParts": {
            "items": {
              "$ref": "#/$defs/TargetingValueDayPartTargetingDayPart"
            },
            "type": "array"
          },
          "timeZoneType": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "TargetingValueDayPartTargetingDayPart": {
        "properties": {
          "dayOfWeek": {
            "type": "string"
          },
          "endHour": {
            "format": "int32",
            "type": "integer"
          },
          "endMinute": {
            "format": "int32",
            "type": "integer"
          },
          "startHour": {
            "format": "int32",
            "type": "integer"
          },
          "startMinute": {
            "format": "int32",
            "type": "integer"
          }
        },
        "type": "object"
      },
      "TargetingValueDemogAgeCriteria": {
        "properties": {
          "demogAgeCriteriaIds": {
            "items": {
              "type": "string"
            },
            "type": "array"
          }
        },
        "type": "object"
      },
      "TargetingValueDemogGenderCriteria": {
        "properties": {
          "demogGenderCriteriaIds": {
            "items": {
              "type": "string"
            },
            "type": "array"
          }
        },
        "type": "object"
      },
      "TargetingValueRequestPlatformTargeting": {
        "properties": {
          "requestPlatforms": {
            "items": {
              "type": "string"
            },
            "type": "array"
          }
        },
        "type": "object"
      },
      "DealTerms": {
        "properties": {
          "brandingType": {
            "description": "Visibility of the URL in bid requests.",
            "type": "string"
          },
          "crossListedExternalDealIdType": {
            "description": "Indicates that this ExternalDealId exists under at least two different AdxInventoryDeals. Currently, the only case that the same ExternalDealId will exist is programmatic cross sell case.",
            "type": "string"
          },
          "description": {
            "description": "Description for the proposed terms of the deal.",
            "type": "string"
          },
          "estimatedGrossSpend": {
            "$ref": "#/$defs/Price"
          },
          "estimatedImpressionsPerDay": {
            "description": "Non-binding estimate of the impressions served per day Can be set by buyer or seller.",
            "format": "int64",
            "type": "string"
          },
          "guaranteedFixedPriceTerms": {
            "$ref": "#/$defs/DealTermsGuaranteedFixedPriceTerms"
          },
          "nonGuaranteedAuctionTerms": {
            "$ref": "#/$defs/DealTermsNonGuaranteedAuctionTerms"
          },
          "nonGuaranteedFixedPriceTerms": {
            "$ref": "#/$defs/DealTermsNonGuaranteedFixedPriceTerms"
          },
          "rubiconNonGuaranteedTerms": {
            "$ref": "#/$defs/DealTermsRubiconNonGuaranteedTerms"
          },
          "sellerTimeZone": {
            "description": "For deals with Cost Per Day billing, defines the timezone used to mark the boundaries of a day (buyer-readonly)",
            "type": "string"
          }
        },
        "type": "object"
      },
      "Price": {
        "properties": {
          "amountMicros": {
            "description": "The price value in micros.",
            "format": "double",
            "type": "number"
          },
          "currencyCode": {
            "description": "The currency code for the price.",
            "type": "string"
          },
          "expectedCpmMicros": {
            "description": "In case of CPD deals, the expected CPM in micros.",
            "format": "double",
            "type": "number"
          },
          "pricingType": {
            "description": "The pricing type for the deal/product.",
            "type": "string"
          }
        },
        "type": "object"
      },
      "DealTermsGuaranteedFixedPriceTerms": {
        "properties": {
          "billingInfo": {
            "$ref": "#/$defs/DealTermsGuaranteedFixedPriceTermsBillingInfo"
          },
          "fixedPrices": {
            "description": "Fixed price for the specified buyer.",
            "items": {
              "$ref": "#/$defs/PricePerBuyer"
            },
            "type": "array"
          },
          "guaranteedImpressions": {
            "description": "Guaranteed impressions as a percentage. This is the percentage of guaranteed looks that the buyer is guaranteeing to buy.",
            "format": "int64",
            "type": "string"
          },
          "guaranteedLooks": {
            "description": "Count of guaranteed looks. Required for deal, optional for product. For CPD deals, buyer changes to guaranteed_looks will be ignored.",
            "format": "int64",
            "type": "string"
          },
          "minimumDailyLooks": {
            "description": "Count of minimum daily looks for a CPD deal. For CPD deals, buyer should negotiate on this field instead of guaranteed_looks.",
            "format": "int64",
            "type": "string"
          }
        },
        "type": "object"
      },
      "DealTermsGuaranteedFixedPriceTermsBillingInfo": {
        "properties": {
          "currencyConversionTimeMs": {
            "description": "The timestamp (in ms since epoch) when the original reservation price for the deal was first converted to DFP currency. This is used to convert the contracted price into buyer's currency without discrepancy.",
            "format": "int64",
            "type": "string"
          },
          "dfpLineItemId": {
            "description": "The DFP line item id associated with this deal. For features like CPD, buyers can retrieve the DFP line item for billing reconciliation.",
            "format": "int64",
            "type": "string"
          },
          "originalContractedQuantity": {
            "description": "The original contracted quantity (# impressions) for this deal. To ensure delivery, sometimes the publisher will book the deal with a impression buffer, such that guaranteed_looks is greater than the contracted quantity. However clients are billed using the original contracted quantity.",
            "format": "int64",
            "type": "string"
          },
          "price": {
            "$ref": "#/$defs/Price"
          }
        },
        "type": "object"
      },
      "PricePerBuyer": {
        "description": "Used to specify pricing rules for buyers. Each PricePerBuyer in a product can become [0,1] deals. To check if there is a PricePerBuyer for a particular buyer we look for the most specific matching rule - we first look for a rule matching the buyer and otherwise look for a matching rule where no buyer is set.",
        "properties": {
          "auctionTier": {
            "description": "Optional access type for this buyer.",
            "type": "string"
          },
          "billedBuyer": {
            "$ref": "#/$defs/Buyer"
          },
          "buyer": {
            "$ref": "#/$defs/Buyer"
          },
          "price": {
            "$ref": "#/$defs/Price"
          }
        },
        "type": "object"
      },
      "Buyer": {
        "properties": {
          "accountId": {
            "description": "Adx account id of the buyer.",
            "type": "string"
          }
        },
        "type": "object"
      },
      "DealTermsNonGuaranteedAuctionTerms": {
        "properties": {
          "autoOptimizePrivateAuction": {
            "description": "True if open auction buyers are allowed to compete with invited buyers in this private auction (buyer-readonly).",
            "type": "boolean"
          },
          "reservePricePerBuyers": {
            "description": "Reserve price for the specified buyer.",
            "items": {
              "$ref": "#/$defs/PricePerBuyer"
            },
            "type": "array"
          }
        },
        "type": "object"
      },
      "DealTermsNonGuaranteedFixedPriceTerms": {
        "properties": {
          "fixedPrices": {
            "description": "Fixed price for the specified buyer.",
            "items": {
              "$ref": "#/$defs/PricePerBuyer"
            },
            "type": "array"
          }
        },
        "type": "object"
      },
      "DealTermsRubiconNonGuaranteedTerms": {
        "properties": {
          "priorityPrice": {
            "$ref": "#/$defs/Price"
          },
          "standardPrice": {
            "$ref": "#/$defs/Price"
          }
        },
        "type": "object"
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://www.googleapis.com/adexchangebuyer/v1.4/proposals/{proposalId}/deals/insert{?alt,fields,key,oauth_token,prettyPrint,quotaUser,userIp}"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**deals**: List of deals added (in the same proposal as passed in the request)",
            "**proposalRevisionNumber**: The updated revision number for the proposal."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
