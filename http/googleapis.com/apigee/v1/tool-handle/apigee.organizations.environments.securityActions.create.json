{
  "name": "apigee_organizations_environments_securityActions_create",
  "description": "CreateSecurityAction creates a SecurityAction.",
  "parameters": {
    "type": "object",
    "properties": {
      "parent": {
        "type": "string",
        "description": "Required. The organization and environment that this SecurityAction applies to. Format: organizations/{org}/environments/{env}"
      },
      "securityActionId": {
        "type": "string",
        "description": "Required. The ID to use for the SecurityAction, which will become the final component of the action's resource name. This value should be 0-61 characters, and valid format is (^[a-z]([a-z0-9-]{â€‹0,61}[a-z0-9])?$)."
      },
      "$.xgafv": {
        "enum": [
          "1",
          "2"
        ],
        "type": "string",
        "description": "V1 error format."
      },
      "access_token": {
        "type": "string",
        "description": "OAuth access token."
      },
      "alt": {
        "enum": [
          "json",
          "media",
          "proto"
        ],
        "type": "string",
        "description": "Data format for response."
      },
      "callback": {
        "type": "string",
        "description": "JSONP"
      },
      "fields": {
        "type": "string",
        "description": "Selector specifying which fields to include in a partial response."
      },
      "key": {
        "type": "string",
        "description": "API key. Your API key identifies your project and provides you with API access, quota, and reports. Required unless you provide an OAuth 2.0 token."
      },
      "oauth_token": {
        "type": "string",
        "description": "OAuth 2.0 token for the current user."
      },
      "prettyPrint": {
        "type": "boolean",
        "description": "Returns response with indentations and line breaks."
      },
      "quotaUser": {
        "type": "string",
        "description": "Available to use for quota purposes for server-side applications. Can be any arbitrary string assigned to a user, but should not exceed 40 characters."
      },
      "upload_protocol": {
        "type": "string",
        "description": "Upload protocol for media (e.g. \"raw\", \"multipart\")."
      },
      "uploadType": {
        "type": "string",
        "description": "Legacy upload protocol for media (e.g. \"media\", \"multipart\")."
      },
      "body": {
        "$ref": "#/$defs/GoogleCloudApigeeV1SecurityAction"
      }
    },
    "required": [
      "parent"
    ],
    "$defs": {
      "GoogleCloudApigeeV1SecurityAction": {
        "description": "A SecurityAction is rule that can be enforced at an environment level. The result is one of: - A denied API call - An explicitly allowed API call - A flagged API call (HTTP headers added before the target receives it) At least one condition is required to create a SecurityAction.",
        "properties": {
          "allow": {
            "$ref": "#/$defs/GoogleCloudApigeeV1SecurityActionAllow"
          },
          "conditionConfig": {
            "$ref": "#/$defs/GoogleCloudApigeeV1SecurityActionConditionConfig"
          },
          "createTime": {
            "description": "Output only. The create time for this SecurityAction.",
            "format": "google-datetime",
            "readOnly": true,
            "type": "string"
          },
          "deny": {
            "$ref": "#/$defs/GoogleCloudApigeeV1SecurityActionDeny"
          },
          "description": {
            "description": "Optional. An optional user provided description of the SecurityAction.",
            "type": "string"
          },
          "expireTime": {
            "description": "The expiration for this SecurityAction.",
            "format": "google-datetime",
            "type": "string"
          },
          "flag": {
            "$ref": "#/$defs/GoogleCloudApigeeV1SecurityActionFlag"
          },
          "name": {
            "description": "Immutable. This field is ignored during creation as per AIP-133. Please set the `security_action_id` field in the CreateSecurityActionRequest when creating a new SecurityAction. Format: organizations/{org}/environments/{env}/securityActions/{security_action}",
            "type": "string"
          },
          "state": {
            "description": "Required. Only an ENABLED SecurityAction is enforced. An ENABLED SecurityAction past its expiration time will not be enforced.",
            "enum": [
              "STATE_UNSPECIFIED",
              "ENABLED",
              "DISABLED"
            ],
            "type": "string"
          },
          "ttl": {
            "description": "Input only. The TTL for this SecurityAction.",
            "format": "google-duration",
            "type": "string"
          },
          "updateTime": {
            "description": "Output only. The update time for this SecurityAction. This reflects when this SecurityAction changed states.",
            "format": "google-datetime",
            "readOnly": true,
            "type": "string"
          }
        },
        "type": "object"
      },
      "GoogleCloudApigeeV1SecurityActionAllow": {
        "description": "Message that should be set in case of an Allow Action. This does not have any fields.",
        "properties": {},
        "type": "object"
      },
      "GoogleCloudApigeeV1SecurityActionConditionConfig": {
        "description": "The following are a list of conditions. A valid SecurityAction must contain at least one condition. Within a condition, each element is ORed. Across conditions elements are ANDed. For example if a SecurityAction has the following: ip_address_ranges: [\"ip1\", \"ip2\"] and bot_reasons: [\"Flooder\", \"Robot Abuser\"] then this is interpreted as: enforce the action if the incoming request has ((ip_address_ranges = \"ip1\" OR ip_address_ranges = \"ip2\") AND (bot_reasons=\"Flooder\" OR bot_reasons=\"Robot Abuser\")). Conditions other than ip_address_ranges and bot_reasons cannot be ANDed.",
        "properties": {
          "accessTokens": {
            "description": "Optional. A list of access_tokens. Limit 1000 per action.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "apiKeys": {
            "description": "Optional. A list of API keys. Limit 1000 per action.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "apiProducts": {
            "description": "Optional. A list of API Products. Limit 1000 per action.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "botReasons": {
            "description": "Optional. A list of Bot Reasons. Current options: Flooder, Brute Guessor, Static Content Scraper, OAuth Abuser, Robot Abuser, TorListRule, Advanced Anomaly Detection, Advanced API Scraper, Search Engine Crawlers, Public Clouds, Public Cloud AWS, Public Cloud Azure, and Public Cloud Google.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "developerApps": {
            "description": "Optional. A list of developer apps. Limit 1000 per action.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "developers": {
            "description": "Optional. A list of developers. Limit 1000 per action.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "ipAddressRanges": {
            "description": "Optional. A list of IP addresses. This could be either IPv4 or IPv6. Limited to 100 per action.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "userAgents": {
            "description": "Optional. A list of user agents to deny. We look for exact matches. Limit 50 per action.",
            "items": {
              "type": "string"
            },
            "type": "array"
          }
        },
        "type": "object"
      },
      "GoogleCloudApigeeV1SecurityActionDeny": {
        "description": "Message that should be set in case of a Deny Action.",
        "properties": {
          "responseCode": {
            "description": "Optional. The HTTP response code if the Action = DENY.",
            "format": "int32",
            "type": "integer"
          }
        },
        "type": "object"
      },
      "GoogleCloudApigeeV1SecurityActionFlag": {
        "description": "The message that should be set in the case of a Flag action.",
        "properties": {
          "headers": {
            "description": "Optional. A list of HTTP headers to be sent to the target in case of a FLAG SecurityAction. Limit 5 headers per SecurityAction. At least one is mandatory.",
            "items": {
              "$ref": "#/$defs/GoogleCloudApigeeV1SecurityActionHttpHeader"
            },
            "type": "array"
          }
        },
        "type": "object"
      },
      "GoogleCloudApigeeV1SecurityActionHttpHeader": {
        "description": "An HTTP header.",
        "properties": {
          "name": {
            "description": "The header name to be sent to the target.",
            "type": "string"
          },
          "value": {
            "description": "The header value to be sent to the target.",
            "type": "string"
          }
        },
        "type": "object"
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://apigee.googleapis.com//v1/{parent}/securityActions{?securityActionId,$.xgafv,access_token,alt,callback,fields,key,oauth_token,prettyPrint,quotaUser,upload_protocol,uploadType}"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "A SecurityAction is rule that can be enforced at an environment level. The result is one of: - A denied API call - An explicitly allowed API call - A flagged API call (HTTP headers added before the target receives it) At least one condition is required to create a SecurityAction.",
        "**Key properties:**",
        {
          "$ul": [
            "**allow**: Message that should be set in case of an Allow Action. This does not have any fields.",
            [
              "**conditionConfig**: The following are a list of conditions. A valid SecurityAction must contain at least one condition. Within a condition, each element is ORed. Across conditions elements are ANDed. For example if a SecurityAction has the following: ip_address_ranges: [\"ip1\", \"ip2\"] and bot_reasons: [\"Flooder\", \"Robot Abuser\"] then this is interpreted as: enforce the action if the incoming request has ((ip_address_ranges = \"ip1\" OR ip_address_ranges = \"ip2\") AND (bot_reasons=\"Flooder\" OR bot_reasons=\"Robot Abuser\")). Conditions other than ip_address_ranges and bot_reasons cannot be ANDed.",
              {
                "$ul": [
                  "**accessTokens**: Optional. A list of access_tokens. Limit 1000 per action.",
                  "**apiKeys**: Optional. A list of API keys. Limit 1000 per action.",
                  "**apiProducts**: Optional. A list of API Products. Limit 1000 per action.",
                  "**botReasons**: Optional. A list of Bot Reasons. Current options: Flooder, Brute Guessor, Static Content Scraper, OAuth Abuser, Robot Abuser, TorListRule, Advanced Anomaly Detection, Advanced API Scraper, Search Engine Crawlers, Public Clouds, Public Cloud AWS, Public Cloud Azure, and Public Cloud Google.",
                  "**developerApps**: Optional. A list of developer apps. Limit 1000 per action.",
                  "**developers**: Optional. A list of developers. Limit 1000 per action.",
                  "**ipAddressRanges**: Optional. A list of IP addresses. This could be either IPv4 or IPv6. Limited to 100 per action.",
                  "**userAgents**: Optional. A list of user agents to deny. We look for exact matches. Limit 50 per action."
                ]
              }
            ],
            "**createTime**: Output only. The create time for this SecurityAction.",
            [
              "**deny**: Message that should be set in case of a Deny Action.",
              {
                "$ul": [
                  "**responseCode**: Optional. The HTTP response code if the Action = DENY."
                ]
              }
            ],
            "**description**: Optional. An optional user provided description of the SecurityAction.",
            "**expireTime**: The expiration for this SecurityAction.",
            [
              "**flag**: The message that should be set in the case of a Flag action.",
              {
                "$ul": [
                  "**headers**: Optional. A list of HTTP headers to be sent to the target in case of a FLAG SecurityAction. Limit 5 headers per SecurityAction. At least one is mandatory."
                ]
              }
            ],
            "**name**: Immutable. This field is ignored during creation as per AIP-133. Please set the `security_action_id` field in the CreateSecurityActionRequest when creating a new SecurityAction. Format: organizations/{org}/environments/{env}/securityActions/{security_action}",
            "**state**: Required. Only an ENABLED SecurityAction is enforced. An ENABLED SecurityAction past its expiration time will not be enforced.",
            "**ttl**: Input only. The TTL for this SecurityAction.",
            "**updateTime**: Output only. The update time for this SecurityAction. This reflects when this SecurityAction changed states."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
