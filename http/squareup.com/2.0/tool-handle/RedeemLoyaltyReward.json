{
  "name": "RedeemLoyaltyReward",
  "description": "Redeems a loyalty reward.\n\nThe endpoint sets the reward to the `REDEEMED` terminal state. \n\nIf you are using your own order processing system (not using the \nOrders API), you call this endpoint after the buyer paid for the \npurchase.\n\nAfter the reward reaches the terminal state, it cannot be deleted. \nIn other words, points used for the reward cannot be returned \nto the account.",
  "parameters": {
    "type": "object",
    "properties": {
      "reward_id": {
        "type": "string",
        "description": "The ID of the [loyalty reward](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyReward) to redeem."
      },
      "body": {
        "$ref": "#/components/schemas/RedeemLoyaltyRewardRequest",
        "description": "An object containing the fields to POST for the request.\n\nSee the corresponding object definition for field details."
      }
    },
    "required": [
      "reward_id",
      "body"
    ]
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://connect.squareup.com/v2/loyalty/rewards/{reward_id}/redeem"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "A response that includes the `LoyaltyEvent` published for redeeming the reward.",
        "**Key properties:**",
        {
          "$ul": [
            "**errors**: Any errors that occurred during the request.",
            [
              "**event**: Provides information about a loyalty event. ",
              {
                "$ul": [
                  [
                    "**accumulate_points**: Provides metadata when the event `type` is `ACCUMULATE_POINTS`.",
                    {
                      "$ul": [
                        "**loyalty_program_id**: The ID of the [loyalty program](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyProgram).",
                        "**order_id**: The ID of the [order](https://developer.squareup.com/reference/square_2021-08-18/objects/Order) for which the buyer accumulated the points.",
                        "**points**: The number of points accumulated by the event."
                      ]
                    }
                  ],
                  [
                    "**adjust_points**: Provides metadata when the event `type` is `ADJUST_POINTS`.",
                    {
                      "$ul": [
                        "**loyalty_program_id**: The Square-assigned ID of the [loyalty program](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyProgram).",
                        "**points**: The number of points added or removed.",
                        "**reason**: The reason for the adjustment of points."
                      ]
                    }
                  ],
                  [
                    "**create_reward**: Provides metadata when the event `type` is `CREATE_REWARD`.",
                    {
                      "$ul": [
                        "**loyalty_program_id**: The ID of the [loyalty program](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyProgram).",
                        "**points**: The loyalty points used to create the reward.",
                        "**reward_id**: The Square-assigned ID of the created [loyalty reward](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyReward)."
                      ]
                    }
                  ],
                  "**created_at**: The timestamp when the event was created, in RFC 3339 format.",
                  [
                    "**delete_reward**: Provides metadata when the event `type` is `DELETE_REWARD`.",
                    {
                      "$ul": [
                        "**loyalty_program_id**: The ID of the [loyalty program](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyProgram).",
                        "**points**: The number of points returned to the loyalty account.",
                        "**reward_id**: The ID of the deleted [loyalty reward](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyReward)."
                      ]
                    }
                  ],
                  [
                    "**expire_points**: Provides metadata when the event `type` is `EXPIRE_POINTS`.",
                    {
                      "$ul": [
                        "**loyalty_program_id**: The Square-assigned ID of the [loyalty program](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyProgram).",
                        "**points**: The number of points expired."
                      ]
                    }
                  ],
                  "**id**: The Square-assigned ID of the loyalty event.",
                  "**location_id**: The ID of the [location](https://developer.squareup.com/reference/square_2021-08-18/objects/Location) where the event occurred.",
                  "**loyalty_account_id**: The ID of the [loyalty account](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyAccount) in which the event occurred.",
                  [
                    "**other_event**: Provides metadata when the event `type` is `OTHER`.",
                    {
                      "$ul": [
                        "**loyalty_program_id**: The Square-assigned ID of the [loyalty program](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyProgram).",
                        "**points**: The number of points added or removed."
                      ]
                    }
                  ],
                  [
                    "**redeem_reward**: Provides metadata when the event `type` is `REDEEM_REWARD`.",
                    {
                      "$ul": [
                        "**loyalty_program_id**: The ID of the [loyalty program](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyProgram).",
                        "**order_id**: The ID of the [order](https://developer.squareup.com/reference/square_2021-08-18/objects/Order) that redeemed the reward.",
                        "**reward_id**: The ID of the redeemed [loyalty reward](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyReward)."
                      ]
                    }
                  ],
                  "**source**: Defines whether the event was generated by the Square Point of Sale.",
                  "**type**: The type of the loyalty event."
                ]
              }
            ]
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
