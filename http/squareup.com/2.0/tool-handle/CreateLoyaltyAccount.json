{
  "name": "CreateLoyaltyAccount",
  "description": "Creates a loyalty account. To create a loyalty account, you must provide the `program_id` and a `mapping` with the `phone_number` of the buyer.",
  "parameters": {
    "type": "object",
    "properties": {
      "body": {
        "$ref": "#/components/schemas/CreateLoyaltyAccountRequest",
        "description": "An object containing the fields to POST for the request.\n\nSee the corresponding object definition for field details."
      }
    },
    "required": [
      "body"
    ]
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://connect.squareup.com/v2/loyalty/accounts"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "A response that includes loyalty account created.",
        "**Key properties:**",
        {
          "$ul": [
            "**errors**: Any errors that occurred during the request.",
            [
              "**loyalty_account**: Describes a loyalty account. For more information, see",
              {
                "$ul": [
                  "**balance**: The available point balance in the loyalty account. If points are scheduled to expire, they are listed in the `expiring_point_deadlines` field.",
                  "**created_at**: The timestamp when the loyalty account was created, in RFC 3339 format.",
                  "**customer_id**: The Square-assigned ID of the [customer](https://developer.squareup.com/reference/square_2021-08-18/objects/Customer) that is associated with the account.",
                  "**enrolled_at**: The timestamp when enrollment occurred, in RFC 3339 format.",
                  "**expiring_point_deadlines**: The schedule for when points expire in the loyalty account balance. This field is present only if the account has points that are scheduled to expire. ",
                  "**id**: The Square-assigned ID of the loyalty account.",
                  "**lifetime_points**: The total points accrued during the lifetime of the account.",
                  [
                    "**mapping**: Represents the mapping that associates a loyalty account with a buyer. ",
                    {
                      "$ul": [
                        "**created_at**: The timestamp when the mapping was created, in RFC 3339 format.",
                        "**id**: The Square-assigned ID of the mapping.",
                        "**phone_number**: The phone number of the buyer, in E.164 format. For example, \"+14155551111\"."
                      ]
                    }
                  ],
                  "**program_id**: The Square-assigned ID of the [loyalty program](https://developer.squareup.com/reference/square_2021-08-18/objects/LoyaltyProgram) to which the account belongs.",
                  "**updated_at**: The timestamp when the loyalty account was last updated, in RFC 3339 format."
                ]
              }
            ]
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
