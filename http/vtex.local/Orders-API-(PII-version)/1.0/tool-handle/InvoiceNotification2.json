{
  "name": "InvoiceNotification2",
  "description": "Once the order is invoiced, the seller should use this request to send the invoice information to the marketplace.\n\nWe strongly recommend that you always send the object of the invoiced items. With this practice, rounding errors will be avoided.\n\nIt is not allowed to use the same `invoiceNumber` in more than one request to the Order Invoice Notification endpoint.\n\nBe aware that this endpoint is also used by the seller to send the order tracking information. This, however, should be done in a separate moment, once the seller has the tracking information.\n\r\n\r> The `Notify invoice` resource is needed to use this API request. This is included in `OMS - Full access` and `IntegrationProfile - Fulfillment Oms`, among other default roles available in the Admin. Learn more about the [License manager roles and resources](https://help.vtex.com/en/tutorial/roles--7HKK5Uau2H6wxE1rH5oRbc#).",
  "parameters": {
    "type": "object",
    "properties": {
      "Content-Type": {
        "example": "application/json",
        "type": "string",
        "description": "Type of the content being sent."
      },
      "Accept": {
        "example": "application/json",
        "type": "string",
        "description": "HTTP Client Negotiation _Accept_ Header. Indicates the types of responses the client can understand."
      },
      "orderId": {
        "example": "70caf3941s6df1",
        "type": "string",
        "description": "ID of the order."
      },
      "body": {
        "$ref": "#/$defs/InvoiceNotificationRequest"
      }
    },
    "required": [
      "Content-Type",
      "Accept",
      "orderId",
      "body"
    ],
    "$defs": {
      "InvoiceNotificationRequest": {
        "example": {
          "courier": null,
          "extraValue": 100,
          "invoiceKey": null,
          "invoiceNumber": "9999",
          "invoiceUrl": null,
          "invoiceValue": 2499,
          "issuedDate": "2019-01-30",
          "items": [
            {
              "id": "1234",
              "price": 10000,
              "quantity": 1
            }
          ],
          "trackingNumber": null,
          "trackingUrl": null,
          "type": "Output"
        },
        "properties": {
          "cfop": {
            "description": "Fiscal code used in Brazil.",
            "example": "6.104",
            "type": "string"
          },
          "courier": {
            "description": "The name of the carrier responsible for delivering the order.\n\r> This field should only be used when sending **tracking** information. When the request is used for sending the invoice, this field should be left empty (`\"\"`).",
            "nullable": true,
            "type": "string"
          },
          "extraValue": {
            "description": "Extra value in the invoice in cents. Do not use any decimal separator. For instance, `$24.99` should be represented as `2499`.",
            "example": 100,
            "type": "integer"
          },
          "invoiceKey": {
            "description": "Invoice key.",
            "nullable": true,
            "type": "string"
          },
          "invoiceNumber": {
            "description": "Number that identifies the invoice.",
            "example": "123456789",
            "type": "string"
          },
          "invoiceUrl": {
            "description": "URL of the invoice. Can be used to send the URL of an XML file, for example, which is useful for some integrations.",
            "type": "string"
          },
          "invoiceValue": {
            "description": "Total amount being invoiced in cents. Do not use any decimal separator. For instance, `$24.99` should be represented as `2499`.",
            "example": 2499,
            "type": "string"
          },
          "issuedDate": {
            "description": "Issuance date of the invoice in ISO format.",
            "example": "2020-07-15",
            "type": "string"
          },
          "items": {
            "description": "Array containing the SKUs that are being invoiced.",
            "items": {
              "$ref": "#/$defs/Item1"
            },
            "type": "array"
          },
          "trackingNumber": {
            "description": "Code that identifies the order tracking.\n\r> This field should only be used when sending the **tracking** information. When the request is used for sending the invoice, this field should be left empty (`\"\"`).",
            "nullable": true,
            "type": "string"
          },
          "trackingUrl": {
            "description": "URL used to track the order.\n\r> This field should only be used when sending the **tracking** information. When the request is used for sending the invoice, this field should be left empty (`\"\"`).",
            "nullable": true,
            "type": "string"
          },
          "type": {
            "description": "The type of invoice. There are two possible values: `\"Output\"` and `\"Input\"`. The `\"Output\"` type should be used when the invoice you are sending is a selling invoice. The `\"Input\"` type should be used when you send a return invoice.",
            "example": "Output",
            "type": "string"
          },
          "volumes": {
            "description": "Number of volumes in the invoice.",
            "example": 3,
            "type": "integer"
          }
        },
        "required": [
          "type",
          "issuedDate",
          "invoiceNumber",
          "invoiceValue",
          "items"
        ],
        "title": "InvoiceNotificationRequest",
        "type": "object"
      },
      "Item1": {
        "example": {
          "id": "1234",
          "price": 10000,
          "quantity": 1
        },
        "properties": {
          "itemIndex": {
            "description": "Index of the SKU being invoiced.",
            "example": 67,
            "type": "string"
          },
          "price": {
            "description": "Total price of the SKU being invoiced in cents. Do not use any decimal separator. For instance, `$24.99` should be represented as `2499`.",
            "example": 2499,
            "format": "int32",
            "type": "integer"
          },
          "quantity": {
            "description": "Quantity cof the SKU being invoiced.",
            "example": 3,
            "format": "int32",
            "type": "integer"
          }
        },
        "required": [
          "itemIndex",
          "price",
          "quantity"
        ],
        "title": "Item1",
        "type": "object"
      }
    }
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://vtex.local/api/orders/pvt/document/{orderId}/invoices"
    },
    "headers": {
      "Content-Type": {
        "$": "Content-Type"
      },
      "Accept": {
        "$": "Accept"
      }
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "Object"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**date**: Date and time when the notification was received.",
            "**orderId**: Identification of the order in the seller.",
            "**receipt**: Protocol code generated by the update. It may be `null`."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
