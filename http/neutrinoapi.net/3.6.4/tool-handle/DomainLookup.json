{
  "name": "DomainLookup",
  "description": "Retrieve domain name details and detect potentially malicious or dangerous domains",
  "parameters": {
    "type": "object",
    "properties": {
      "host": {
        "type": "string",
        "description": "A domain name, hostname, FQDN, URL, HTML link or email address to lookup"
      },
      "live": {
        "default": true,
        "type": "boolean",
        "description": "For domains that we have never seen before then perform various live checks and realtime reconnaissance. <br>NOTE: this option may add additional non-deterministic delay to the request, if you require consistently fast API response times or just want to check our domain blocklists then you can disable this option"
      }
    },
    "required": [
      "host"
    ]
  },
  "handler": "http",
  "request": {
    "method": "GET",
    "url": {
      "$uri": "https://neutrinoapi.net/domain-lookup{?host,live}"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "DomainLookupResponse"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**age**: The number of days since the domain was registered. A domain age of under 90 days is generally considered to be potentially risky. A value of 0 indicates no registration date was found for this domain",
            "**blocklists**: An array of strings indicating which blocklist categories this domain is listed on. Current categories are: phishing, malware, spam, anonymizer, nefarious",
            "**dns-provider**: The primary domain of the DNS provider for this domain",
            "**domain**: The primary domain name excluding any subdomains. This is also referred to as the second-level domain (SLD)",
            "**fqdn**: The fully qualified domain name (FQDN)",
            "**is-adult**: This domain is hosting adult content such as porn, webcams, escorts, etc",
            "**is-gov**: Is this domain under a government or military TLD",
            "**is-malicious**: Consider this domain malicious as it is currently listed on at least 1 blocklist",
            "**is-opennic**: Is this domain under an OpenNIC TLD",
            "**is-pending**: True if this domain is unseen and is currently being processed in the background. This field only matters when the 'live' lookup setting has been explicitly disabled and indicates that not all domain data my be present yet",
            "**is-subdomain**: Is the FQDN a subdomain of the primary domain",
            "**mail-provider**: The primary domain of the email provider for this domain. An empty value indicates the domain has no valid MX records",
            "**rank**: The domains estimated global traffic rank with the highest rank being 1. A value of 0 indicates the domain is currently ranked outside of the top 1M of domains",
            "**registered-date**: The ISO date this domain was registered or first seen on the internet. An empty value indicates we could not reliably determine the date",
            "**registrar-id**: The IANA registrar ID (0 if no registrar ID was found)",
            "**registrar-name**: The name of the domain registrar owning this domain",
            "**sensors**: An array of objects containing details on which specific blocklist sensors have detected this domain",
            "**tld**: The top-level domain (TLD)",
            "**tld-cc**: For a country code top-level domain (ccTLD) this will contain the associated ISO 2-letter country code",
            "**valid**: True if a valid domain was found. For a domain to be considered valid it must be registered and have valid DNS NS records"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "400": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "APIError"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**api-error**: API error code. If set and > 0 then an API error has occurred your request could not be completed",
            "**api-error-msg**: API error message"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "403": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "APIError"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**api-error**: API error code. If set and > 0 then an API error has occurred your request could not be completed",
            "**api-error-msg**: API error message"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "500": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "APIError"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**api-error**: API error code. If set and > 0 then an API error has occurred your request could not be completed",
            "**api-error-msg**: API error message"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "default": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "APIError"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**api-error**: API error code. If set and > 0 then an API error has occurred your request could not be completed",
            "**api-error-msg**: API error message"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
