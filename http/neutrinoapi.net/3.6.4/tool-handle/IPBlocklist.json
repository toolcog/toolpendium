{
  "name": "IPBlocklist",
  "description": "The IP Blocklist API will detect potentially malicious or dangerous IP addresses",
  "parameters": {
    "type": "object",
    "properties": {
      "ip": {
        "type": "string",
        "description": "An IPv4 or IPv6 address. Accepts standard IP notation (with or without port number), CIDR notation and IPv6 compressed notation. If multiple IPs are passed using comma-separated values the first non-bogon address on the list will be checked"
      },
      "vpn-lookup": {
        "default": false,
        "type": "boolean",
        "description": "Include public VPN provider IP addresses. <br><b>NOTE</b>: For more advanced VPN detection including the ability to identify private and stealth VPNs use the <a href=\"https://www.neutrinoapi.com/api/ip-probe/\">IP Probe API</a>"
      }
    },
    "required": [
      "ip"
    ]
  },
  "handler": "http",
  "request": {
    "method": "GET",
    "url": {
      "$uri": "https://neutrinoapi.net/ip-blocklist{?ip,vpn-lookup}"
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "IPBlocklistResponse"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**blocklists**: An array of strings indicating which blocklist categories this IP is listed on",
            "**cidr**: The CIDR address for this listing (only set if the IP is listed)",
            "**ip**: The IP address",
            "**is-bot**: IP is hosting a malicious bot or is part of a botnet. This is a broad category which includes brute-force crackers",
            "**is-dshield**: IP has been flagged as a significant attack source by DShield (dshield.org)",
            "**is-exploit-bot**: IP is hosting an exploit finding bot or is running exploit scanning software",
            "**is-hijacked**: IP is part of a hijacked netblock or a netblock controlled by a criminal organization",
            "**is-listed**: Is this IP on a blocklist",
            "**is-malware**: IP is involved in distributing or is running malware",
            "**is-proxy**: IP has been detected as an anonymous web proxy or anonymous HTTP proxy",
            "**is-spam-bot**: IP address is hosting a spam bot, comment spamming or any other spamming type software",
            "**is-spider**: IP is running a hostile web spider / web crawler",
            "**is-spyware**: IP is involved in distributing or is running spyware",
            "**is-tor**: IP is a Tor node or running a Tor related service",
            "**is-vpn**: IP belongs to a public VPN provider (only set if the 'vpn-lookup' option is enabled)",
            "**last-seen**: The unix time when this IP was last seen on any blocklist. IPs are automatically removed after 7 days therefor this value will never be older than 7 days",
            "**list-count**: The number of blocklists the IP is listed on",
            "**sensors**: An array of objects containing details on which specific sensors detected the IP"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "400": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "APIError"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**api-error**: API error code. If set and > 0 then an API error has occurred your request could not be completed",
            "**api-error-msg**: API error message"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "403": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "APIError"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**api-error**: API error code. If set and > 0 then an API error has occurred your request could not be completed",
            "**api-error-msg**: API error message"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "500": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "APIError"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**api-error**: API error code. If set and > 0 then an API error has occurred your request could not be completed",
            "**api-error-msg**: API error message"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    },
    "default": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "APIError"
        },
        "**Key properties:**",
        {
          "$ul": [
            "**api-error**: API error code. If set and > 0 then an API error has occurred your request could not be completed",
            "**api-error-msg**: API error message"
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
