{
  "name": "POST_RefundCreditMemo",
  "description": "**Note:** This operation is only available if you have [Invoice Settlement](https://knowledgecenter.zuora.com/Billing/Billing_and_Payments/Invoice_Settlement) enabled. The Invoice Settlement feature is generally available as of Zuora Billing Release 296 (March 2021). This feature includes Unapplied Payments, Credit and Debit Memo, and Invoice Item Settlement. If you want to enable Invoice Settlement, see [Invoice Settlement Enablement and Checklist Guide](https://knowledgecenter.zuora.com/Billing/Billing_and_Payments/Invoice_Settlement/Invoice_Settlement_Migration_Checklist_and_Guide) for more information. \n\nRefunds a full or partial posted credit memo to your customers. Only the amount of unapplied part could be refunded. \n\nYou can refund a credit memo only if you have the user permission. See [Billing Roles](https://knowledgecenter.zuora.com/CF_Users_and_Administrators/A_Administrator_Settings/User_Roles/d_Billing_Roles) for more information.\n\nWhen you refund a credit memo, the total number of credit memo items to be refunded must be less than or equal to 10,000.\n\nFor a use case of this operation, see [Refund processing](https://www.zuora.com/developer/api-guides/#Refund-processing).\n",
  "parameters": {
    "type": "object",
    "properties": {
      "Zuora-Track-Id": {
        "maxLength": 64,
        "type": "string",
        "description": "A custom identifier for tracing the API call. If you set a value for this header, Zuora returns the same value in the response headers. This header enables you to associate your system process identifiers with Zuora API calls, to assist with troubleshooting in the event of an issue.\n\nThe value of this field must use the US-ASCII character set and must not include any of the following characters: colon (`:`), semicolon (`;`), double quote (`\"`), and quote (`'`).\n"
      },
      "Zuora-Entity-Ids": {
        "type": "string",
        "description": "An entity ID. If you have [Zuora Multi-entity](https://knowledgecenter.zuora.com/BB_Introducing_Z_Business/Multi-entity) enabled and the OAuth token is valid for more than one entity, you must use this header to specify which entity to perform the operation in. If the OAuth token is only valid for a single entity, or you do not have Zuora Multi-entity enabled, you do not need to set this header.\n"
      },
      "creditmemoId": {
        "type": "string",
        "description": "The unique ID of a credit memo. For example, 8a8082e65b27f6c3015ba45ff82c7172.\n"
      }
    },
    "required": [
      "creditmemoId"
    ]
  },
  "handler": "http",
  "request": {
    "method": "POST",
    "url": {
      "$uri": "https://rest.zuora.com/v1/creditmemos/{creditmemoId}/refunds"
    },
    "headers": {
      "Zuora-Track-Id": {
        "$": "Zuora-Track-Id"
      },
      "Zuora-Entity-Ids": {
        "$": "Zuora-Entity-Ids"
      }
    }
  },
  "responses": {
    "200": {
      "$encode": "markdown",
      "$block": [
        {
          "$h1": "refundFieldsNS"
        },
        "Container for Refund fields provided by the [Zuora Connector for NetSuite](https://www.zuora.com/connect/app/?appId=265).\n",
        "**Key properties:**",
        {
          "$ul": [
            "**accountId**: The ID of the account associated with this refund. Zuora associates the refund automatically with the account from the associated payment.",
            "**amount**: The total amount of the refund.",
            "**cancelledOn**: The date and time when the refund was cancelled, in `yyyy-mm-dd hh:mm:ss` format.",
            "**comment**: Comments about the refund.",
            "**createdById**: The ID of the Zuora user who created the refund.",
            "**createdDate**: The date and time when the refund was created, in `yyyy-mm-dd hh:mm:ss` format. For example, 2017-03-06 15:31:10.",
            "**creditMemoId**: The ID of the credit memo that is refunded.",
            [
              "**financeInformation**: Container for the finance information related to the refund.",
              {
                "$ul": [
                  "**bankAccountAccountingCode**: The accounting code that maps to a bank account in your accounting system.",
                  "**bankAccountAccountingCodeType**: The type of the accounting code that maps to a bank account in your accounting system.",
                  "**transferredToAccounting**: Whether the refund was transferred to an external accounting system. Use this field for integration with accounting systems, such as NetSuite. ",
                  "**unappliedPaymentAccountingCode**: The accounting code for the unapplied payment.",
                  "**unappliedPaymentAccountingCodeType**: The type of the accounting code for the unapplied payment."
                ]
              }
            ],
            "**gatewayId**: The ID of the gateway instance that processes the refund.",
            "**gatewayResponse**: The message returned from the payment gateway for the refund. This message is gateway-dependent.",
            "**gatewayResponseCode**: The response code returned from the payment gateway for the refund. This code is gateway-dependent.",
            "**gatewayState**: The status of the refund in the gateway.",
            "**id**: The ID of the created refund.",
            "**markedForSubmissionOn**: The date and time when a refund was marked and waiting for batch submission to the payment process, in `yyyy-mm-dd hh:mm:ss` format.",
            "**methodType**: How an external refund was issued to a customer.",
            "**number**: The unique identification number of the refund.",
            "**paymentId**: The ID of the payment associated with the refund.",
            "**paymentMethodId**: The unique ID of the payment method that the customer used to make the refund.",
            "**paymentMethodSnapshotId**: The unique ID of the payment method snapshot, which is a copy of the particular payment method used in a transaction.",
            "**reasonCode**: A code identifying the reason for the transaction.",
            "**referenceId**: The transaction ID returned by the payment gateway for an electronic refund. Use this field to reconcile refunds between your gateway and Zuora Payments.",
            "**refundDate**: The date when the refund takes effect, in yyyy-mm-dd format.",
            "**refundTransactionTime**: The date and time when the refund was issued, in `yyyy-mm-dd hh:mm:ss` format.",
            "**secondRefundReferenceId**: The transaction ID returned by the payment gateway if there is an additional transaction for the refund. Use this field to reconcile payments between your gateway and Zuora Payments.",
            "**settledOn**: The date and time when the refund was settled in the payment processor, in `yyyy-mm-dd hh:mm:ss` format. This field is used by the Spectrum gateway only and not applicable to other gateways.",
            "**softDescriptor**: A payment gateway-specific field that maps to Zuora for the gateways, Orbital, Vantiv and Verifi.",
            "**softDescriptorPhone**: A payment gateway-specific field that maps to Zuora for the gateways, Orbital, Vantiv and Verifi.",
            "**status**: The status of the refund.",
            "**submittedOn**: The date and time when the refund was submitted, in `yyyy-mm-dd hh:mm:ss` format.",
            "**success**: Returns `true` if the request was processed successfully.",
            "**type**: The type of the refund.",
            "**updatedById**: The ID of the Zuora user who last updated the refund.",
            "**updatedDate**: The date and time when the refund was last updated, in `yyyy-mm-dd hh:mm:ss` format. For example, 2017-03-07 15:36:10.",
            "**IntegrationId__NS**: ID of the corresponding object in NetSuite. Only available if you have installed the [Zuora Connector for NetSuite](https://www.zuora.com/connect/app/?appId=265).",
            "**IntegrationStatus__NS**: Status of the refund's synchronization with NetSuite. Only available if you have installed the [Zuora Connector for NetSuite](https://www.zuora.com/connect/app/?appId=265).",
            "**Origin__NS**: Origin of the corresponding object in NetSuite. Only available if you have installed the [Zuora Connector for NetSuite](https://www.zuora.com/connect/app/?appId=265).",
            "**SyncDate__NS**: Date when the refund was synchronized with NetSuite. Only available if you have installed the [Zuora Connector for NetSuite](https://www.zuora.com/connect/app/?appId=265).",
            "**SynctoNetSuite__NS**: Specifies whether the refund should be synchronized with NetSuite. Only available if you have installed the [Zuora Connector for NetSuite](https://www.zuora.com/connect/app/?appId=265)."
          ]
        },
        {
          "$lang": "json",
          "$code": {
            "$encode": "json",
            "$indent": true,
            "$content": {
              "$": "$.body"
            }
          }
        }
      ]
    }
  }
}
