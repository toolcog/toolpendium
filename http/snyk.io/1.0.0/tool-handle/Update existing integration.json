{
  "name": "Update_existing_integration",
  "description": "+ Update integration's credentials for given organization. Integration must be **not brokered**\n\n+ Enable or disable brokered integration for given organization. *Credentials required for disabling brokered integration*\n\nExamples in right section:\n\n1. Set up a broker for an existing integration\n\n2. Update credentials for an existing non-brokered integration\n\n3. Disable broker for an existing integration",
  "parameters": {
    "type": "object",
    "properties": {
      "orgId": {
        "type": "string",
        "description": "The organization ID. The `API_KEY` must have admin access to this organization."
      },
      "integrationId": {
        "type": "string",
        "description": "The unique identifier for the configured integration. This can be found on the [Integration page in the Settings area](https://app.snyk.io/manage/integrations) for all integrations that have been configured."
      },
      "body": {
        "anyOf": [
          {
            "example": {
              "broker": {
                "enabled": true
              },
              "type": "github"
            },
            "properties": {
              "broker": {
                "description": "brokered integration settings",
                "properties": {
                  "enabled": {
                    "type": "boolean"
                  }
                },
                "type": "object"
              },
              "type": {
                "description": "integration type",
                "enum": [
                  "acr",
                  "artifactory-cr",
                  "azure-repos",
                  "bitbucket-cloud",
                  "bitbucket-server",
                  "digitalocean-cr",
                  "docker-hub",
                  "ecr",
                  "gcr",
                  "github",
                  "github-cr",
                  "github-enterprise",
                  "gitlab",
                  "gitlab-cr",
                  "google-artifact-cr",
                  "harbor-cr",
                  "nexus-cr",
                  "quay-cr"
                ],
                "type": "string"
              }
            },
            "required": [
              "type",
              "broker"
            ],
            "type": "object"
          },
          {
            "example": {
              "credentials": {
                "token": "GITLAB_TOKEN"
              },
              "type": "gitlab"
            },
            "properties": {
              "credentials": {
                "description": "credentials for given integration",
                "oneOf": [
                  {
                    "properties": {
                      "AcrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `name.azurecr.io`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "ArtifactoryCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `name.jfrog.io`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "AzureReposCredentials": {
                        "properties": {
                          "url": {
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "url"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "BitbucketCloudCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "BitbucketServerCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "url": {
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "url"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "DigitalOceanCrCredentials": {
                        "properties": {
                          "token": {
                            "description": "Personal Access Token",
                            "type": "string"
                          }
                        },
                        "required": [
                          "token"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "DockerHubCredentials": {
                        "properties": {
                          "password": {
                            "description": "Access Token",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "EcrCredentials": {
                        "properties": {
                          "region": {
                            "description": "e.g.: `eu-west-3`",
                            "type": "string"
                          },
                          "roleArn": {
                            "description": "e.g.: `arn:aws:iam::<account-id>:role/<newRole>`",
                            "type": "string"
                          }
                        },
                        "required": [
                          "region",
                          "roleArn"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GcrCredentials": {
                        "properties": {
                          "password": {
                            "description": "JSON key file",
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `gcr.io`, `us.gcr.io`, `eu.gcr.io`, `asia.gcr.io`",
                            "type": "string"
                          }
                        },
                        "required": [
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GitHubCredentials": {
                        "properties": {
                          "token": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "token"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GitHubCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `ghcr.io`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GitHubEnterpriseCredentials": {
                        "properties": {
                          "token": {
                            "type": "string"
                          },
                          "url": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "token",
                          "url"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GitLabCredentials": {
                        "properties": {
                          "token": {
                            "type": "string"
                          },
                          "url": {
                            "description": "for self-hosted GitLab only",
                            "type": "string"
                          }
                        },
                        "required": [
                          "token"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GitLabCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `your.gitlab.host`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GoogleArtifactCrCredentials": {
                        "properties": {
                          "password": {
                            "description": "JSON key file",
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `us-east1-docker.pkg.dev`, `europe-west1-docker.pkg.dev`",
                            "type": "string"
                          }
                        },
                        "required": [
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "HarborCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `your.harbor.host`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "NexusCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `your.nexus.host`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "QuayCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `quay.io`, `your.quay.host`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  }
                ],
                "properties": {},
                "type": "object"
              },
              "type": {
                "description": "integration type",
                "enum": [
                  "acr",
                  "artifactory-cr",
                  "azure-repos",
                  "bitbucket-cloud",
                  "bitbucket-server",
                  "digitalocean-cr",
                  "docker-hub",
                  "ecr",
                  "gcr",
                  "github",
                  "github-cr",
                  "github-enterprise",
                  "gitlab",
                  "gitlab-cr",
                  "google-artifact-cr",
                  "harbor-cr",
                  "nexus-cr",
                  "quay-cr"
                ],
                "type": "string"
              }
            },
            "required": [
              "type",
              "credentials"
            ],
            "type": "object"
          },
          {
            "example": {
              "broker": {
                "enabled": false
              },
              "credentials": {
                "token": "GITHUB_TOKEN"
              },
              "type": "github"
            },
            "properties": {
              "broker": {
                "description": "brokered integration settings",
                "properties": {
                  "enabled": {
                    "type": "boolean"
                  }
                },
                "type": "object"
              },
              "credentials": {
                "description": "credentials for given integration",
                "oneOf": [
                  {
                    "properties": {
                      "AcrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `name.azurecr.io`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "ArtifactoryCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `name.jfrog.io`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "AzureReposCredentials": {
                        "properties": {
                          "url": {
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "url"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "BitbucketCloudCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "BitbucketServerCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "url": {
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "url"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "DigitalOceanCrCredentials": {
                        "properties": {
                          "token": {
                            "description": "Personal Access Token",
                            "type": "string"
                          }
                        },
                        "required": [
                          "token"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "DockerHubCredentials": {
                        "properties": {
                          "password": {
                            "description": "Access Token",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "EcrCredentials": {
                        "properties": {
                          "region": {
                            "description": "e.g.: `eu-west-3`",
                            "type": "string"
                          },
                          "roleArn": {
                            "description": "e.g.: `arn:aws:iam::<account-id>:role/<newRole>`",
                            "type": "string"
                          }
                        },
                        "required": [
                          "region",
                          "roleArn"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GcrCredentials": {
                        "properties": {
                          "password": {
                            "description": "JSON key file",
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `gcr.io`, `us.gcr.io`, `eu.gcr.io`, `asia.gcr.io`",
                            "type": "string"
                          }
                        },
                        "required": [
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GitHubCredentials": {
                        "properties": {
                          "token": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "token"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GitHubCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `ghcr.io`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GitHubEnterpriseCredentials": {
                        "properties": {
                          "token": {
                            "type": "string"
                          },
                          "url": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "token",
                          "url"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GitLabCredentials": {
                        "properties": {
                          "token": {
                            "type": "string"
                          },
                          "url": {
                            "description": "for self-hosted GitLab only",
                            "type": "string"
                          }
                        },
                        "required": [
                          "token"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GitLabCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `your.gitlab.host`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "GoogleArtifactCrCredentials": {
                        "properties": {
                          "password": {
                            "description": "JSON key file",
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `us-east1-docker.pkg.dev`, `europe-west1-docker.pkg.dev`",
                            "type": "string"
                          }
                        },
                        "required": [
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "HarborCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `your.harbor.host`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "NexusCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `your.nexus.host`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  },
                  {
                    "properties": {
                      "QuayCrCredentials": {
                        "properties": {
                          "password": {
                            "type": "string"
                          },
                          "registryBase": {
                            "description": "e.g.: `quay.io`, `your.quay.host`",
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "username",
                          "password",
                          "registryBase"
                        ],
                        "type": "object"
                      }
                    }
                  }
                ],
                "properties": {},
                "type": "object"
              },
              "type": {
                "description": "integration type",
                "enum": [
                  "acr",
                  "artifactory-cr",
                  "azure-repos",
                  "bitbucket-cloud",
                  "bitbucket-server",
                  "digitalocean-cr",
                  "docker-hub",
                  "ecr",
                  "gcr",
                  "github",
                  "github-cr",
                  "github-enterprise",
                  "gitlab",
                  "gitlab-cr",
                  "google-artifact-cr",
                  "harbor-cr",
                  "nexus-cr",
                  "quay-cr"
                ],
                "type": "string"
              }
            },
            "required": [
              "type",
              "broker",
              "credentials"
            ],
            "type": "object"
          }
        ]
      }
    },
    "required": [
      "orgId",
      "integrationId"
    ]
  },
  "handler": "http",
  "request": {
    "method": "PUT",
    "url": {
      "$uri": "https://api.snyk.io/v1/org/{orgId}/integrations/{integrationId}"
    },
    "body": {
      "$": "body",
      "encode": "json"
    }
  },
  "responses": {}
}
